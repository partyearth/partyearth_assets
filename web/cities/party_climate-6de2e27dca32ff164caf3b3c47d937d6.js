pe.ReadMore=function(a,b,d){0<a.length&&(pe.init_widget(this,a),this.read_more_control_selector=".ReadMoreControl",this.read_more_control=this.container.find(this.read_more_control_selector),this.read_less_control_selector=".ReadLessControl",this.read_less_control=this.container.find(this.read_less_control_selector),this.read_more_link=this.container.find(".ReadMoreLink"),this.read_more_link.click(this.callback(this.on_read_more_link_clicked)),this.read_less_link=this.container.find(".ReadLessLink"),
this.read_less_link.click(this.callback(this.on_read_less_link_clicked)),this.long_description_selector=".LongDescription",this.long_description=this.container.find(this.long_description_selector),this.thumbs_selector=".thumbnails",this.thumbs=this.container.find(this.thumbs_selector),this.photos_selector=".photo",this.photos=this.container.find(this.photos_selector),this.read_more_handler=b,this.read_less_handler=d)};pe.ReadMore.events={LONG_DESC_OPENED:"ReadMore_LONG_DESC_OPENED"};
pe.ReadMore.instantiate_all=function(){var a=$(".ReadMore");0<a.length&&new pe.ReadMore(a)};pe.ReadMore.prototype.on_read_more_link_clicked=function(a){this.expand_section($(a.currentTarget).closest(this.container.selector));pe.fire_global_event(pe.ReadMore.events.LONG_DESC_OPENED);"function"===typeof this.read_more_handler&&this.read_more_handler()};
pe.ReadMore.prototype.expand_section=function(a){0<a.length?(a.find(this.long_description_selector).removeClass("clipped"),a.find(this.read_less_control_selector).show(),a.find(this.read_more_control_selector).hide(),a.find(this.thumbs_selector).addClass("hidden"),a.find(this.photos_selector).removeClass("hidden")):(this.long_description.removeClass("clipped"),this.read_less_control.show(),this.read_more_control.hide(),this.thumbs.addClass("hidden"),this.photos.removeClass("hidden"))};
pe.ReadMore.prototype.collapse_section=function(a){0<a.length?(a.find(this.read_less_control_selector).hide(),a.find(this.read_more_control_selector).show(),a.find(this.thumbs_selector).removeClass("hidden"),a.find(this.photos_selector).addClass("hidden"),a.find(this.long_description_selector).addClass("clipped")):(this.read_less_control.hide(),this.read_more_control.show(),this.thumbs.removeClass("hidden"),this.photos.addClass("hidden"),this.long_description.addClass("clipped"))};
pe.ReadMore.prototype.on_read_less_link_clicked=function(a){this.collapse_section($(a.currentTarget).closest(this.container.selector));"function"===typeof this.read_less_handler&&this.read_less_handler()};pe.ReadMore.instantiate=function(){return $.map($(".ReadMore"),function(a){return new pe.ReadMore($(a))})};
pe.PhotoModule=function(a,b,d,f,e,g){pe.init_widget(this,a);this.container.html(this.dom(d));this.slide_show_div=this.container.find(".SlideShow");this.slide_show_div.html(this.render_photos(b,f,e,g));0<b.length&&(this.slide_show_div.addClass("slider"),this.slide_show_div.nivoSlider({effect:"slideInRight",startSlide:0,animSpeed:70,pauseTime:0,directionNav:1<b.length,directionNavHide:!0,controlNav:!1,keyboardNav:!0,manualAdvance:!0}))};
pe.PhotoModule.prototype.dom=function(a){return'<div class="SlideShow '+a+'"></div>'};
pe.PhotoModule.prototype.render_photos=function(a,b,d,f){var e="";if(0===a.length)e+='<img src="'+pe.https(pe.assign_photo_size("",b,d))+'" alt="" title="">';else{var g=this,h=a.length;$.each(a,function(a,c){c.photo=pe.https(pe.assign_photo_size(c.src,b,d));c.position=a+1+" of "+h;c.title_div="title_div_"+f+"_"+a;c.photo_caption_container=""===c.title?"":'<div class="photo_caption float_left"><span class="text float_left">'+c.title+'</span><div class="line_divider"></div></div>';g.container.append(pe.templatize('<div id="{{title_div}}" class="nivo-html-caption"><table width="100%" cellpadding="0" cellspacing="0"><tbody><tr><td width="90%">{{photo_caption_container}}</td><td valign="bottom"><div class="photo_number float_right"><span class="text"><nobr>{{position}}</nobr></span><div></td></tr></tbody></table></div>',
c));e=c.url?e+pe.templatize('<a href="{{url}}"><img src="{{photo}}" alt="" title="#{{title_div}}"/></a>',c):e+pe.templatize('<img src="{{photo}}" alt="" title="#{{title_div}}"/>',c)})}return e};pe.HelpModule=function(a,b,d){pe.init_widget(this,a);this.help_module_open=!1;this.help_id=b;this.container.append(this.html(d));this.container.click(this.callback(this.help_button_clicked));this.help_button_div=this.container.find(".HelpButton");(this.admin_link=this.container.find(".AdminLink"))&&this.admin_link.click(this.callback(this.admin_link_clicked))};
pe.HelpModule.prototype.html=function(a){var b="";0===this.container.contents().length&&(b+='<div class="help_btn HelpButton"></div>');a&&(b+='<div><a class="AdminLink admin_edit" target="_blank" href="/admin/pages/'+this.help_id+'/edit">Edit Tip</a></div>');return b};pe.HelpModule.prototype.admin_link_clicked=function(a){a.stopPropagation()};
pe.HelpModule.prototype.help_button_clicked=function(a){this.help_module_open?a.stopPropagation():pe.ajax_loader.help_page.load({page_id:this.help_id},this.callback(function(a){a=$(this.dialog_box_html(a));this.help_button_div.append(a);this.help_module_open=!0;new pe.CloseButton(a,this.callback(this.close_dialog,a))}))};
pe.HelpModule.prototype.dialog_box_html=function(a){return pe.templatize('<div class="DialogBox dialog_box"><div class="dialog_content_wrapper clearfix"><div class="CloseButton close_btn" title="Close"></div><div class="dialog_img"></div><div class="dialog_content"> <h1>{{title}}</h1>{{content}}</div></div></div><div class="dialog_point"><div class="dialog_inner_point"></div></div>',a)};pe.HelpModule.prototype.close_dialog=function(a,b){this.help_module_open=!1;a.remove();b.stopPropagation()};
$(document).ready(function(){pe.ReadMore.instantiate();pe.ajax_loader.city_photos.load({city_id:window.city_data.id},function(a){new pe.PhotoModule($(".PhotoSlideShow"),a,"width334","334","334x252","party_climate")});setTimeout(function(){pe.init_page_framework()},10)});
