with(jqUnit)test("pe.VenueSearcher.filter_by_neighborhood() disables venues not in the given neighborhood",function(){var a={id:"one",neighborhood_id:"n1"},b={id:"two",neighborhood_id:"n2"},c=new pe.SearchConfiguration;c.add_filter("neighborhood","n1");c=pe.VenueSearcher.filter_by_neighborhood([a,b],c);assert_that(c,[a,b]);assert_that(typeof a.disabled,"undefined");assert_that(b.disabled,!0)}),test("pe.VenueSearcher.filter_by_city() returns venues from the given city",function(){var a=fakeVenue("one",
{city:"city1"}),b=fakeVenue("two",{city:"city2"}),c=new pe.SearchConfiguration;c.add_filter("city","city1");b=pe.VenueSearcher.filter_by_city([a,b],c);assert_that(b,[a])}),test("pe.VenueSearcher.filter_by_city() returns all venues if no city given",function(){var a=fakeVenue("one",{city:"city1"}),b=fakeVenue("two",{city:"city2"}),c=new pe.SearchConfiguration,c=pe.VenueSearcher.filter_by_city([a,b],c);assert_that(c,[a,b])}),test("pe.VenueSearcher.filter_by_character_type removes venues that are below the threshold for the given character",
function(){var a=fakeVenue("one",{rating_adriana:3}),b=fakeVenue("two",{rating_adriana:2}),c=new pe.SearchConfiguration;c.add_filter("characters",["adriana"]);b=pe.VenueSearcher.filter_by_character([a,b],c);assert_that(b,[a])}),test("pe.VenueSearcher.filter_by_character_type removes venues that are below the threshold for the given characters",function(){var a=fakeVenue("one",{rating_adriana:3,rating_lucas:3}),b=fakeVenue("two",{rating_adriana:3,rating_lucas:2}),c=fakeVenue("three",{rating_adriana:2,
rating_lucas:3}),d=fakeVenue("four",{rating_adriana:2,rating_lucas:2}),d=[a,b,c,d],e=new pe.SearchConfiguration;e.add_filter("characters",["adriana","lucas"]);d=pe.VenueSearcher.filter_by_character(d,e);assert_that(d,[a,b,c])}),test("pe.VenueSearcher.filter_by_character_type returns all venues if no character filter is given",function(){var a=fakeVenue("one",{rating_adriana:3}),b=fakeVenue("two",{rating_adriana:2}),c=new pe.SearchConfiguration,c=pe.VenueSearcher.filter_by_character([a,b],c);assert_that(c,
[a,b])}),test("pe.VenueSearcher.filter_by_character_type returns no venues if empty filter is given",function(){var a=fakeVenue("one",{rating_adriana:3}),b=fakeVenue("two",{rating_adriana:2}),c=new pe.SearchConfiguration;c.add_filter("characters",[]);a=pe.VenueSearcher.filter_by_character([a,b],c);assert_that(a,[])}),test("pe.VenueSearcher.filter_by_fulltext()",function(){var a={id:"one",name:"one"},b=[a,{id:"two",name:"two"}],c=new pe.SearchConfiguration;c.add_filter("fulltext","one");b=pe.VenueSearcher.filter_by_fulltext(b,
c);assert_that(b,[a])}),test("pe.VenueSearcher.filter_by_venue_type removes venues that are not of the given types",function(){var a={id:"one",all_venue_types:["Bar"],venue_types:[]},b={id:"one",all_venue_types:["Bar","Club"],venue_types:[]},c=[a,{id:"one",all_venue_types:["Club"],venue_types:[]},b],d=new pe.SearchConfiguration;d.add_filter("Venue Type",["Bar"]);c=pe.VenueSearcher.filter_by_venue_types(c,d);assert_that(c,[a,b])}),test("pe.VenueSearcher.filter_by_venue_type handles no venue types filter given",
function(){var a={id:"one",all_venue_types:["Bar"],venue_types:[]},b={id:"one",all_venue_types:["Club"],venue_types:[]},c=[a,b],d=new pe.SearchConfiguration,c=pe.VenueSearcher.filter_by_venue_types(c,d);assert_that(c,[a,b])}),test("pe.VenueSearcher.filter_by_venue_type handles empty venue types filter given",function(){var a=new pe.SearchConfiguration;a.add_filter("Venue Type",[]);a=pe.VenueSearcher.filter_by_venue_types([{id:"one",all_venue_types:["Bar"],venue_types:[]},{id:"one",all_venue_types:["Club"],
venue_types:[]}],a);assert_that(a,[])}),test("pe.VenueSearcher.filter_by_result_type removes all venues if 'all venues' is deselected",function(){var a=new pe.SearchConfiguration;a.add_filter("result_types",["events"]);a=pe.VenueSearcher.filter_by_result_types([{id:"one",hotspot_days:[]},{id:"two",hotspot_days:[]}],a);assert_that(a,[])}),test("pe.VenueSearcher.filter_by_result_type returns all venues if 'all venues' is selected",function(){var a=[{id:"one",hotspot_days:[]},{id:"two",hotspot_days:[]}],
b=new pe.SearchConfiguration;b.add_filter("result_types",["venues"]);b=pe.VenueSearcher.filter_by_result_types(a,b);assert_that(b,a)}),test("pe.VenueSearcher.filter_by_result_type returns hotspots venues if 'all venues' is deselected and 'hotspots' is selected",function(){var a={id:"one",hotspot_days:[1]},b=[a,{id:"two",hotspot_days:[2]}],c=new pe.SearchConfiguration;c.add_filter("result_types",["hotspots"]);c.add_filter("start_date","10/11/2010");b=pe.VenueSearcher.filter_by_result_types(b,c);assert_that(b,
[a])}),test("pe.VenueSearcher.filter_by_tags()",function(){var a={id:"one",tags:["Beer","Wine"]},b=[a,{id:"two",tags:["Cocktail"]}],c=new pe.SearchConfiguration;c.add_filter("tags",{"Food/Drink":["Beer"]});b=pe.VenueSearcher.filter_by_tags(b,c);assert_that(b,[a])}),test("pe.VenueSearcher.filter_by_tags() ignores event-related tags",function(){var a={id:"one",tags:["Beer"]},b={id:"two",tags:["Cocktail"]},c=[a,b],d=new pe.SearchConfiguration;d.add_filter("tags",{"Event Type":["Concert"]});c=pe.VenueSearcher.filter_by_tags(c,
d);assert_that(c,[a,b])}),test("pe.VenueSearcher.filter_by_venue_name() returns only the venues with the given names",function(){var a={id:"one",name:"One"},b={id:"two",name:"Two"},c=[a,b,{id:"three",name:"Three"}],d=new pe.SearchConfiguration;d.add_filter("venue_name",["One","Two"]);c=pe.VenueSearcher.filter_by_venue_name(c,d);assert_that(c,[a,b])}),test("pe.VenueSearcher.filter_by_venue_name() returns all venues if no venue name filter is given",function(){var a=[{id:"one",name:"One"},{id:"two",
name:"Two"}],b=new pe.SearchConfiguration,b=pe.VenueSearcher.filter_by_venue_name(a,b);assert_that(b,a)}),test("pe.VenueSearcher.find_hotspots()",function(){var a={hotspot:!0},b=pe.VenueSearcher.find_hotspots([a,{hotspot:!1}]);assert_that(b,[a])}),test("pe.VenueSearcher.find_map_hotspots()",function(){var a={map_icon:pe.Map.marker_types.HOTSPOT},b=pe.VenueSearcher.find_map_hotspots([a,{map_icon:pe.Map.marker_types.VENUE}]);assert_that(b,[a])}),test("pe.VenueSearcher.find_non_hotspots()",function(){var a=
fakeVenue("venue",{map_icon:pe.Map.marker_types.VENUE}),b=fakeVenue("hotspot",{map_icon:pe.Map.marker_types.HOTSPOT}),b=pe.VenueSearcher.find_map_venues([a,b]);assert_that(b,[a])}),test("pe.VenueSearcher.find_used_tags() returns matching tags",function(){var a=pe.VenueSearcher.find_used_tags({Prices:{Expensive:[],Bargain:[]},"Venue Type":{"Music Venue":["Concert Venue","Live Music Venue"],Shopping:["Farmer's Market","Flea Market"],Park:["City Park"],Club:["Dance Club","Jazz Club","Night Club"]},"Food/Drink":{Tequila:[],
"Snack Food":[]}},[{name:"expensive dance club",tags:["Dance Club","Expensive"]},{name:"bargain park",tags:["Park","Bargain"]}]);assert_that(pe.hash_length(a),2);assert_that(a.Prices,{Expensive:[],Bargain:[]});assert_that(a["Venue Type"],{Park:[],Club:["Dance Club"]})}),test("pe.VenueSearcher.get_day_of_week_range",function(){assert_that(pe.VenueSearcher.get_day_of_week_range(pe.test_data.monday_date,pe.test_data.wednesday_date),[1,2,3]);assert_that(pe.VenueSearcher.get_day_of_week_range(pe.test_data.saturday_date,
pe.test_data.monday_date),[6,0,1]);assert_that(pe.VenueSearcher.get_day_of_week_range(pe.test_data.saturday_date,""),[6]);assert_that(pe.VenueSearcher.get_day_of_week_range(pe.test_data.sunday_date,pe.test_data.sunday_date),[0]);assert_that(pe.VenueSearcher.get_day_of_week_range("01/01/2000","01/12/2000"),[0,1,2,3,4,5,6])}),test("pe.VenueSearcher.mark_hotspots()",function(){var a={hotspot_days:[1,2]},b={hotspot_days:[2,3]},c={hotspot_days:[3,4]},d=[a,b,c],e=new pe.SearchConfiguration;e.add_filter("start_date",
pe.test_data.monday_date_str);e.add_filter("end_date",pe.test_data.tuesday_date_str);pe.VenueSearcher.mark_hotspots(d,e);assert_that(a.hotspot,!0);assert_that(b.hotspot,!0);assert_that(c.hotspot,!1)}),test("pe.VenueSearcher.mark_hotspots() with same start and end date",function(){var a={hotspot_days:[1,2]},b={hotspot_days:[2,3]},c=[a,b],d=new pe.SearchConfiguration;d.add_filter("start_date",pe.test_data.monday_date_str);d.add_filter("end_date",pe.test_data.monday_date_str);pe.VenueSearcher.mark_hotspots(c,
d);assert_that(a.hotspot,!0);assert_that(b.hotspot,!1)}),test("pe.VenueSearcher.mark_venue_map_visibility() with selected venues",function(){var a=fakeVenue("one"),b=[a],c=new pe.SearchConfiguration;c.add_filter("result_types",["venues","hotspots"]);pe.VenueSearcher.mark_venue_map_visibility(b,c);assert_that(a.map_visibility,!0);assert_that(a.map_icon,pe.Map.marker_types.VENUE)}),test("pe.VenueSearcher.mark_venue_map_visibility() with deselected venues",function(){var a=fakeVenue("one"),b=[a],c=new pe.SearchConfiguration;
c.add_filter("result_types",[]);pe.VenueSearcher.mark_venue_map_visibility(b,c);assert_that(a.map_visibility,!1);assert_that(a.map_icon,pe.Map.marker_types.VENUE)}),test("pe.VenueSearcher.mark_venue_map_visibility() with selected hotspots",function(){var a={hotspot:!0},b=[a],c=new pe.SearchConfiguration;c.add_filter("result_types",["hotspots"]);pe.VenueSearcher.mark_venue_map_visibility(b,c);assert_that(a.hotspot,!0);assert_that(a.map_visibility,!0);assert_that(a.map_icon,pe.Map.marker_types.HOTSPOT)}),
test("pe.VenueSearcher.mark_venue_map_visibility() with deselected hotspots but selected venues",function(){var a={hotspot:!0},b=[a],c=new pe.SearchConfiguration;c.add_filter("result_types",["venues"]);pe.VenueSearcher.mark_venue_map_visibility(b,c);assert_that(a.hotspot,!0);assert_that(a.map_visibility,!0);assert_that(a.map_icon,pe.Map.marker_types.VENUE)}),test("pe.VenueSearcher.mark_venue_map_visibility() with deselected hotspots and venues",function(){var a={hotspot:!0},b=[a],c=new pe.SearchConfiguration;
c.add_filter("result_types",[]);pe.VenueSearcher.mark_venue_map_visibility(b,c);assert_that(a.map_visibility,!1)}),test("pe.VenueSearcher.remove_event_tags()",function(){var a=pe.VenueSearcher.remove_event_tags({"Event Type":["Club Night","Comedy"],"Venue Type":["Bar"]});assert_that(a,{"Venue Type":["Bar"]})}),test("pe.VenueSearcher.venue_is_hotspot_on_date",function(){venue={hotspot_days:[1,2]};assert_that(pe.VenueSearcher.venue_is_hotspot_on_date(venue,0),!1);assert_that(pe.VenueSearcher.venue_is_hotspot_on_date(venue,
1),!0);assert_that(pe.VenueSearcher.venue_is_hotspot_on_date(venue,2),!0);assert_that(pe.VenueSearcher.venue_is_hotspot_on_date(venue,3),!1)}),test("pe.VenueSearcher.venue_is_hotspot_in_date_range() with date range",function(){var a={hotspot_days:[1,2]};assert_that(pe.VenueSearcher.venue_is_hotspot_in_date_range(a,pe.test_data.sunday_date,pe.test_data.monday_date),!0);assert_that(pe.VenueSearcher.venue_is_hotspot_in_date_range(a,pe.test_data.sunday_date,pe.test_data.tuesday_date),!0);assert_that(pe.VenueSearcher.venue_is_hotspot_in_date_range(a,
pe.test_data.sunday_date,pe.test_data.wednesday_date),!0);assert_that(pe.VenueSearcher.venue_is_hotspot_in_date_range(a,pe.test_data.tuesday_date,pe.test_data.wednesday_date),!0);assert_that(pe.VenueSearcher.venue_is_hotspot_in_date_range(a,pe.test_data.wednesday_date,pe.test_data.thursday_date),!1)});
