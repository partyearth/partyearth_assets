pe.Input=function(a,b){pe.init_widget(this,a);this.options=b;this.options.label||(this.options.label="");this.container.html(this.html(this.options));this.carrier=this.options.carrier||null;this.state=b.initial_state?b.initial_state:pe.Input.states.UNCHECKED;this.update_ui();this.type=b.type;this.click_state=pe.Input.click_states.NOT_PRESSED;this.disabled=!1;this.container.addClass(b.type);this.container.click(this.callback(this.clicked));this.container.mousedown(this.callback(this.mouse_down));this.container.mouseup(this.callback(this.mouse_up))};
pe.Input.events={CHANGED:"Input_CHANGED"};pe.Input.states={CHECKED:"CHECKED",UNCHECKED:"UNCHECKED"};pe.Input.click_states={PRESSED:"PRESSED",NOT_PRESSED:"NOT PRESSED"};pe.Input.types={CHECKBOX:"Checkbox",RADIO_BUTTON:"RadioButton"};pe.Input.prototype.clicked=function(a){this.toggle_checked_status();this.update_ui();a&&a.stopPropagation();this.fire_event(pe.Input.events.CHANGED,this)};pe.Input.prototype.check=function(){this.set_checked(!0)};pe.Input.prototype.disable=function(){this.disabled=!0;this.update_ui()};
pe.Input.prototype.enable=function(){this.disabled=!1;this.update_ui()};pe.Input.prototype.is_checked=function(){return this.state===pe.Input.states.CHECKED};pe.Input.prototype.html=function(a){return pe.templatize('<div class="Input input_selection"></div>{{label}}',a)};pe.Input.prototype.mouse_down=function(){this.click_state=pe.Input.click_states.PRESSED;this.update_ui()};pe.Input.prototype.mouse_up=function(){this.click_state=pe.Input.click_states.NOT_PRESSED;this.update_ui()};
pe.Input.prototype.set_checked=function(a){this.state=a?pe.Input.states.CHECKED:pe.Input.states.UNCHECKED;this.carrier&&this.carrier.attr("checked",a);this.update_ui()};pe.Input.prototype.toggle_checked_status=function(){this.set_checked(!this.is_checked())};pe.Input.prototype.uncheck=function(){this.set_checked(!1)};
pe.Input.prototype.update_ui=function(){this.container.removeClass("checked unchecked checked_pressed unchecked_pressed checked_disabled unchecked_disabled");var a=this.state===pe.Input.states.UNCHECKED?"unchecked":"checked",b=this.disabled?"_disabled":"",c=this.click_state===pe.Input.click_states.PRESSED?"_pressed":"";b&&(c="");this.container.addClass(a+b+c)};
pe.FilterCharacters=function(a){pe.init_widget(this,a);this.container.html(this.dom_template());var a=this.callback(this.changed),b=this.container.find(".CharacterChoice.Lucas");this.input_lucas=new pe.Input(b.find(".Input"),{type:pe.Input.types.CHECKBOX,initial_state:pe.Input.states.CHECKED,name:"lucas"});this.input_lucas.bind_event(pe.Input.events.CHANGED,a);b.click(this.callback(this.container_clicked,this.input_lucas));b=this.container.find(".CharacterChoice.Adriana");this.input_adriana=new pe.Input(b.find(".Input"),
{type:pe.Input.types.CHECKBOX,initial_state:pe.Input.states.CHECKED,name:"adriana"});this.input_adriana.bind_event(pe.Input.events.CHANGED,a);b.click(this.callback(this.container_clicked,this.input_adriana));b=this.container.find(".CharacterChoice.Jonah");this.input_jonah=new pe.Input(b.find(".Input"),{type:pe.Input.types.CHECKBOX,initial_state:pe.Input.states.CHECKED,name:"jonah"});this.input_jonah.bind_event(pe.Input.events.CHANGED,a);b.click(this.callback(this.container_clicked,this.input_jonah));
b=this.container.find(".CharacterChoice.Emma");this.input_emma=new pe.Input(b.find(".Input"),{type:pe.Input.types.CHECKBOX,initial_state:pe.Input.states.CHECKED,name:"emma"});this.input_emma.bind_event(pe.Input.events.CHANGED,a);b.click(this.callback(this.container_clicked,this.input_emma));this.inputs=[this.input_lucas,this.input_adriana,this.input_jonah,this.input_emma]};pe.FilterCharacters.events={CHANGED:"FilterCharacters_CHANGED"};
pe.FilterCharacters.prototype.add_search_configuration=function(a){var b=$.map(this.inputs,function(a){if(a.is_checked())return a.options.name});4>b.length&&a.add_filter("characters",b)};pe.FilterCharacters.prototype.changed=function(){this.update_ui();this.fire_event(pe.FilterCharacters.events.CHANGED)};pe.FilterCharacters.prototype.container_clicked=function(a){a.toggle();this.update_ui();this.fire_event(pe.FilterCharacters.events.CHANGED)};pe.FilterCharacters.prototype.dom_template=function(){return'<div class="CharacterChoice Lucas char_choice lucas float_left checked"><div class="Input"></div></div><div class="CharacterChoice Adriana char_choice adriana float_left checked"><div class="Input"></div></div><div class="CharacterChoice Jonah char_choice jonah float_left checked"><div class="Input"></div></div><div class="CharacterChoice Emma char_choice emma float_left checked"><div class="Input"></div></div><div class="clear"></div>'};
pe.FilterCharacters.prototype.read_search_configuration=function(a){if(a=a.get_filter("characters"))this.input_lucas.set_checked(-1<a.indexOf("lucas")),this.input_adriana.set_checked(-1<a.indexOf("adriana")),this.input_jonah.set_checked(-1<a.indexOf("jonah")),this.input_emma.set_checked(-1<a.indexOf("emma")),this.update_ui()};pe.FilterCharacters.prototype.reset=function(){this.input_lucas.check();this.input_adriana.check();this.input_jonah.check();this.input_emma.check();this.update_ui()};
pe.FilterCharacters.prototype.update_ui=function(){$.each(this.inputs,function(a,b){var c=b.container.closest(".CharacterChoice");b.is_checked()?c.addClass("checked"):c.removeClass("checked")})};
