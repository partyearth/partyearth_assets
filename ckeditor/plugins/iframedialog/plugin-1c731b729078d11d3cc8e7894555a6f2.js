CKEDITOR.plugins.add("iframedialog",{requires:["dialog"],onLoad:function(){CKEDITOR.dialog.addIframe=function(e,b,a,f,k,g,h){a={type:"iframe",src:a,width:"100%",height:"100%"};a.onContentLoad="function"==typeof g?g:function(){var b=this.getElement().$.contentWindow;if(b.onDialogEvent){var c=this.getDialog(),a=function(a){return b.onDialogEvent(a)};c.on("ok",a);c.on("cancel",a);c.on("resize",a);c.on("hide",function(b){c.removeListener("ok",a);c.removeListener("cancel",a);c.removeListener("resize",
a);b.removeListener()});b.onDialogEvent({name:"load",sender:this,editor:c._.editor})}};var j={title:b,minWidth:f,minHeight:k,contents:[{id:"iframe",label:b,expand:!0,elements:[a]}]},d;for(d in h)j[d]=h[d];this.add(e,function(){return j})};var l=function(e,b,a){if(!(3>arguments.length)){var f=this._||(this._={}),k=b.onContentLoad&&CKEDITOR.tools.bind(b.onContentLoad,this),g=CKEDITOR.tools.cssLength(b.width),h=CKEDITOR.tools.cssLength(b.height);f.frameId=CKEDITOR.tools.getNextId()+"_iframe";e.on("load",
function(){CKEDITOR.document.getById(f.frameId).getParent().setStyles({width:g,height:h})});var j={src:"%2",id:f.frameId,frameborder:0,allowtransparency:!0},d=[];"function"==typeof b.onContentLoad&&(j.onload="CKEDITOR.tools.callFunction(%1);");CKEDITOR.ui.dialog.uiElement.call(this,e,b,d,"iframe",{width:g,height:h},j,"");a.push('<div style="width:'+g+";height:"+h+';" id="'+this.domId+'"></div>');d=d.join("");e.on("show",function(){var a=CKEDITOR.document.getById(f.frameId).getParent(),c=CKEDITOR.tools.addFunction(k),
c=d.replace("%1",c).replace("%2",CKEDITOR.tools.htmlEncode(b.src));a.setHtml(c)})}};l.prototype=new CKEDITOR.ui.dialog.uiElement;CKEDITOR.dialog.addUIElement("iframe",{build:function(e,b,a){return new l(e,b,a)}})}});
