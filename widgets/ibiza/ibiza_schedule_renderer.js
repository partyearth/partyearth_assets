pe.init_calendar_buttons=function(){new pe.AddToCalendarButton};pe.AddToCalendarButton=function(){pe.init_widget(this,null);$(".AddToCalendarButton").live("click",this.callback(this.show_dialog))};pe.AddToCalendarButton.prototype.close_dialog=function(){};
pe.AddToCalendarButton.prototype.show_dialog=function(a){var b=$('<div title="Add to your calendar">'),c=function(){b.empty();b.dialog("destroy")};b.dialog({modal:!0,show:!1,close:c});b.html('<div style="margin:0 auto; width: 80px;"><img src="/assets/content_bg/spinner.gif"/></div>');a=$(a.currentTarget);pe.ajax_loader.add_to_calendar_dialog.load({event_id:a.data("event_id"),date:a.data("date")},function(a){b.html(a);b.find("a").click(c)});return!1};
pe.IbizaNavigationModule=function(a){pe.init_widget(this,a);this.navigation_links=this.container.find(".IbizaNavigationLink");this.selected_link_data="all";this.navigation_links.click(this.callback(this.navigation_link_clicked))};pe.IbizaNavigationModule.events={CLICKED:"IbizaNavigationModule_CLICKED"};pe.IbizaNavigationModule.prototype.navigation_link_clicked=function(a){a=$(a.target);this.set_selected_link_data(a.attr("data"),a)};
pe.IbizaNavigationModule.prototype.set_selected_link_data=function(a,b){a&&a!==this.selected_link_data&&("expand_all"!==a&&"collapse_all"!==a&&(this.selected_link_data=a,b||(b=this.container.find("[data='"+a+"']")),this.navigation_links.removeClass("selected"),b.addClass("selected")),this.fire_event(pe.IbizaNavigationModule.events.CLICKED,a))};
pe.ServersideAccordion=function(a,b,c){pe.init_widget(this,a);this.accordion_collapsed=!1;this.accordion_label_div=this.container.find(".AccordionLabel");this.content_div=this.container.find(".AccordionContent");this.content_div_height=0;this.expand_collapse_link=this.container.find(".ExpandCollapseLink");this.expand_collapse_link.click(this.callback(this.on_expand_collapse_link_click));this.severside_url=b;c?this.expand_accordion():this.collapse_accordion()};pe.ServersideAccordion.events={EXPANDED:"ServersideAccorderon_EXPANDED"};
pe.ServersideAccordion.prototype.animate=function(a){this.content_div.animate({height:a},300,"cubicEaseInOut")};pe.ServersideAccordion.prototype.collapse_accordion=function(){this.expand_collapse_link.removeClass("collapse_bar_wrapper").addClass("expand_bar_wrapper");this.accordion_label_div.html("Expand");this.accordion_collapsed=!0;this.animate(0)};
pe.ServersideAccordion.prototype.expand_accordion=function(){""!==this.content_div.html()?(this.expand_collapse_link.removeClass("expand_bar_wrapper").addClass("collapse_bar_wrapper"),this.accordion_label_div.html("Collapse"),this.accordion_collapsed=!1,this.animate(this.content_div_height)):$.ajax({url:this.severside_url,type:"GET",error:function(a){alert("error: "+a)},success:this.callback(function(a){this.expand_collapse_link.removeClass("expand_bar_wrapper").addClass("collapse_bar_wrapper");this.accordion_label_div.html("Collapse");
this.content_div.html(a);this.content_div.css("height","auto");this.accordion_collapsed=!1;this.content_div_height=this.content_div.height();this.fire_event(pe.ServersideAccordion.events.EXPANDED);pe.convert_to_rounded_corners()})})};pe.ServersideAccordion.prototype.on_expand_collapse_link_click=function(){this.accordion_collapsed?this.expand_accordion():this.collapse_accordion()};
pe.IbizaScheduleRenderer=function(a,b){pe.init_widget(this,a);this.title_section_div=this.container.find(".TitleSection");this.schedule_section_div=this.container.find(".ScheduleSection");this.active_accordions=this.initialize_accordions();b.bind_event(pe.IbizaNavigationModule.events.CLICKED,this.callback(this.navigation_button_clicked))};
pe.IbizaScheduleRenderer.prototype.initialize_accordions=function(){var a=this.container.find(".CustomAccordion");return 0<a.length?$.map(a,this.callback(function(a,c){var d=$(a);return new pe.ServersideAccordion(d,d.attr("data-url").toString(),0===c)})):null};
pe.IbizaScheduleRenderer.prototype.navigation_button_clicked=function(a,b){"expand_all"===b?$.each(this.active_accordions,function(a,b){setTimeout(function(){b.expand_accordion()},500)}):"collapse_all"===b?$.each(this.active_accordions,function(a,b){b.collapse_accordion()}):$.ajax({url:"/ibiza/schedule/",data:{data:b},type:"GET",success:this.callback(function(a){this.title_section_div.html(a.title_html);this.schedule_section_div.html(a.schedule_html);this.active_accordions=this.initialize_accordions();
pe.convert_to_rounded_corners()})})};
