!function(a){a.cookie=function(t,e,i){if(1<arguments.length&&(!/Object/.test(Object.prototype.toString.call(e))||null===e||e===undefined)){if(i=a.extend({},i),null!==e&&e!==undefined||(i.expires=-1),"number"==typeof i.expires){var n=i.expires,o=i.expires=new Date;o.setDate(o.getDate()+n)}return e=String(e),document.cookie=[encodeURIComponent(t),"=",i.raw?e:encodeURIComponent(e),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var r,s=(i=e||{}).raw?function(t){return t}:decodeURIComponent,c=document.cookie.split("; "),_=0;r=c[_]&&c[_].split("=");_++)if(s(r[0])===t)return s(r[1]||"");return null}}(jQuery),function(){var o=function(t,e){return function(){return t.apply(e,arguments)}};pe.CityBasedEventJumper=function(){function t(t,e,i){var n;this.container=t,this.url=e,this.field_name=i,this.on_write_review_button_clicked=o(this.on_write_review_button_clicked,this),this.on_item_selected=o(this.on_item_selected,this),this.city_changed=o(this.city_changed,this),this.item=null,this.write_review_button=this.container.find(".WriteReviewButton"),this.cities_selector_container=this.container.find(".CitySelector"),this.events_selector_container=this.container.find(".EventSelector"),this.write_review_button.click(this.on_write_review_button_clicked),this.cities_selector_container.change(this.city_changed),this.events_selector_container.change(this.on_item_selected),this.write_review_button.click((n=this,function(){return!!n.events_selector_container.val()}))}return t.prototype.city_changed=function(){return this.city=this.cities_selector_container.val(),this.container=this.events_selector_container,this.options="",this.city?$.getJSON(this.url,{city_id:this.city},(o=this,function(t){var e,i,n;for(e=i=0,n=t.length;0<=n?i<n:n<i;e=0<=n?++i:--i)o.options+='<option value="'+t[e].value+'">'+t[e].label+"</option>";return o.container.html(o.options),o.on_item_selected()})):(this.container.html(this.options),this.on_item_selected());var o},t.prototype.on_item_selected=function(){var t;return(t=this.events_selector_container.val())?(this.write_review_button.attr("href",t+"#WriteComment"),this.write_review_button.removeClass("disabled")):this.write_review_button.addClass("disabled")},t.prototype.on_write_review_button_clicked=function(){var t;return t=JSON.stringify({notice:this.write_review_button.data("message")}),$.cookie("flash",t,{path:"/"}),!0},t}()}.call(this);