(function(){CKEDITOR.dialog.add("templates",function(b){function q(e,d){var g=CKEDITOR.dom.element.createFromHtml('<a href="javascript:void(0)" tabIndex="-1" role="option" ><div class="cke_tpl_item"></div></a>'),a='<table style="width:350px;" class="cke_tpl_preview" role="presentation"><tr>';e.image&&d&&(a+='<td class="cke_tpl_preview_img"><img src="'+CKEDITOR.getUrl(d+e.image)+'"'+(CKEDITOR.env.ie6Compat?' onload="this.width=this.width"':"")+' alt="" title=""></td>');a+='<td style="white-space:normal;"><span class="cke_tpl_title">'+
e.title+"</span><br/>";e.description&&(a+="<span>"+e.description+"</span>");g.getFirst().setHtml(a+"</td></tr></table>");g.on("click",function(){var a=e.html,c=CKEDITOR.dialog.getCurrent();c.getValueOf("selectTpl","chkInsertOpt")?(b.on("contentDom",function(a){a.removeListener();c.hide();a=new CKEDITOR.dom.range(b.document);a.moveToElementEditStart(b.document.getBody());a.select(1);setTimeout(function(){b.fire("saveSnapshot")},0)}),b.fire("saveSnapshot"),b.setData(a)):(b.insertHtml(a),c.hide())});
return g}function j(e){var d=e.data.getTarget(),b=h.equals(d);if(b||h.contains(d)){var a=e.data.getKeystroke(),f=h.getElementsByTag("a"),c;if(f){if(b)c=f.getItem(0);else switch(a){case 40:c=d.getNext();break;case 38:c=d.getPrevious();break;case 13:case 32:d.fire("click")}c&&(c.focus(),e.data.preventDefault())}}}CKEDITOR.skins.load(b,"templates");var h,k="cke_tpl_list_label_"+CKEDITOR.tools.getNextNumber(),f=b.lang.templates,m=b.config;return{title:b.lang.templates.title,minWidth:CKEDITOR.env.ie?440:
400,minHeight:340,contents:[{id:"selectTpl",label:f.title,elements:[{type:"vbox",padding:5,children:[{id:"selectTplText",type:"html",html:"<span>"+f.selectPromptMsg+"</span>"},{id:"templatesList",type:"html",focus:!0,html:'<div class="cke_tpl_list" tabIndex="-1" role="listbox" aria-labelledby="'+k+'"><div class="cke_tpl_loading"><span></span></div></div><span class="cke_voice_label" id="'+k+'">'+f.options+"</span>"},{id:"chkInsertOpt",type:"checkbox",label:f.insertOption,"default":m.templates_replaceContent}]}]}],
buttons:[CKEDITOR.dialog.cancelButton],onShow:function(){var b=this.getContentElement("selectTpl","templatesList");h=b.getElement();CKEDITOR.loadTemplates(m.templates_files,function(){var d=(m.templates||"default").split(",");if(d.length){var g=h;g.setHtml("");for(var a=0,j=d.length;a<j;a++)for(var c=CKEDITOR.getTemplates(d[a]),k=c.imagesPath,c=c.templates,p=c.length,l=0;l<p;l++){var n=q(c[l],k);n.setAttribute("aria-posinset",l+1);n.setAttribute("aria-setsize",p);g.append(n)}b.focus()}else h.setHtml('<div class="cke_tpl_empty"><span>'+
f.emptyListMsg+"</span></div>")});this._.element.on("keydown",j)},onHide:function(){this._.element.removeListener("keydown",j)}}})})();
