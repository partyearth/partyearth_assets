pe.Paginator=function(a,b,c,d){pe.init_widget(this,a);this.objects=null;this.max_page_number=this.current_page_number=0;this.page_size=d;this.search_configuration=null;this.container&&(this.result_entry_constructor=c,this.container.html(this.dom()),this.objects_list=pe.load(this.container.find(".ObjectsList")),this.objects_counter=b,this.prev_button=pe.load(this.container.find(".PrevButton")),this.prev_button.click(this.callback(this.venue_prev_clicked)),this.next_button=pe.load(this.container.find(".NextButton")),
this.next_button.click(this.callback(this.venue_next_clicked)),this.current_page_number_display=pe.load(this.container.find(".CurrentPageNumber")))};pe.Paginator.events={PAGE_CHANGED:"Paginator_PAGE_CHANGED"};pe.Paginator.prototype.calculate_max_page_number=function(a){a=Math.ceil(a/this.page_size);return 0===a?1:a};pe.Paginator.prototype.dom=function(){return'<ul class="ObjectsList"></ul><div class="pod_footer"><div class="prev_next"><span class="PrevButton prev_btn float_left fake_link"></span><span class="NextButton next_btn float_right fake_link"></span><span class="CurrentPageNumber page_count float_right"></span> </div><span class="see_more float_right"></span><div>'};
pe.Paginator.prototype.preload=function(a,b,c){this.objects=a;this.max_page_number=this.calculate_max_page_number(b);this.search_configuration=c;this.show_page(0)};pe.Paginator.prototype.set_objects=function(a,b){null!==a&&(this.objects=$.grep(a,function(a){return!a.disabled}),this.search_configuration=b,this.max_page_number=this.calculate_max_page_number(this.objects.length),this.container&&(this.objects_counter&&this.objects_counter.html(this.objects.length),this.show_page(0)))};
pe.Paginator.prototype.show_page=function(a){this.current_page_number=a;this.current_page_number_display.html(a+1+"/"+this.max_page_number);this.objects_list.html("");for(var a=this.current_page_number*this.page_size,b=0;b<this.page_size;){var c=this.objects[a];if(!c)break;new this.result_entry_constructor(this.objects_list,c,this.search_configuration);b++;a++}0===this.current_page_number?(this.prev_button.addClass("disabled"),0===this.max_page_number-1?this.next_button.addClass("disabled"):this.next_button.removeClass("disabled")):
this.current_page_number>=this.max_page_number-1?(this.prev_button.removeClass("disabled"),this.next_button.addClass("disabled")):(this.prev_button.removeClass("disabled"),this.next_button.removeClass("disabled"));this.fire_event(pe.Paginator.events.PAGE_CHANGED);pe.convert_to_rounded_corners(this.objects_list.find(".ConvertToRoundedCorners"))};
pe.Paginator.prototype.venue_next_clicked=function(a){this.current_page_number>=this.max_page_number-1?a.stopPropagation():this.show_page(this.current_page_number+1)};pe.Paginator.prototype.venue_prev_clicked=function(a){0===this.current_page_number?a.stopPropagation():this.show_page(this.current_page_number-1)};
pe.SearchResultFulltext=function(a,b){pe.init_widget(this,null);this.container=$('<div class="result fulltext"></div>');a.append(this.container);this.container.html(this.dom_template(b));this.container.data("widget",this);this.result=b};
pe.SearchResultFulltext.prototype.dom_template=function(a){switch(a.result_type){case "Venue":return a.sub_type_text=a.sub_type.join("/"),a.city_link_title=pe.link_title_for_city(a.city_name),a.venue_link_title=pe.link_title_for_venue(a.title,a.city_name,a.sub_type_text),a.neighborhood_link_title=pe.link_title_for_neighborhood(a.neighborhood_name,a.city_name),a.photo_text=a.photo_url?pe.templatize('<a href="/venues/{{id}}" class="photo ConvertToRoundedCorners float_left" target="_blank"><img src="'+
pe.https(pe.assign_photo_size(a.photo_url,"75","75x55"))+'"></a>',a):"/assets/no_image_75x55.png",pe.templatize('<div class="result_info"><a href="/venues/{{id}}" class="headline" target="_blank" title="{{venue_link_title}}">{{title}}</a> <br>{{photo_text}}<span class="blue_text">Review</span>&nbsp;&nbsp;<span class="grey_text">{{sub_type_text}} / <a href="/{{city_id}}" class="border_link" target="_blank" title="{{city_link_title}}">{{city_name}}</a> - <a href="/neighborhoods/{{neighborhood_id}}" class="border_link" target="_blank"    title="{{neighborhood_link_title}}">{{neighborhood_name}}</a></span><br><div class="desc">{{description}}<div class="read_more_arrow"><a href="/venues/{{id}}" title="{{venue_link_title}}" class="float_right"></a> </div></div></div>',
a);case "Performer":return a.performer_link_title=pe.link_title_for_performer(a.title),a.has_events_text=!1===a.has_events?"":" / "+("Performer"===a.sub_type?"On Tour":"In Season"),a.photo_text=a.photo_url?pe.templatize('<a href="/performers/{{id}}" title="{{performer_link_title}}" class="photo ConvertToRoundedCorners float_left" target="_blank"><img src="'+pe.https(pe.assign_photo_size(a.photo_url,"75","75x55"))+'"></a>',a):"/assets/no_image_75x55.png",pe.templatize('<div class="result_info"><a href="/performers/{{id}}" title="{{performer_link_title}}" class="headline" target="_blank">{{title}}</a> <br>{{photo_text}}<span class="blue_text">{{sub_type}}</span><span class="grey_text">{{has_events_text}}</span><br><div class="desc">{{description}}<div class="read_more_arrow"><a href="/performers/{{id}}" title="{{performer_link_title}}" class="float_right"></a> </div></div></div>',
a);case "Event":return a.sub_type_text=a.sub_type.join("/"),a.location_text=$.map(a.locations,function(a){if("Venue"===a.type)return a.city_link_title=pe.link_title_for_city(a.city_name),a.venue_link_title=pe.link_title_for_venue(a.venue_name,a.city_name,null),pe.templatize('<a href="/{{city_id}}" class="border_link" target="_blank" title="{{city_link_title}}">{{city_name}}</a> - <a href="/venues/{{venue_id}}" class="border_link" target="_blank" title="{{venue_link_title}}">{{venue_name}}</a>',a);
if("City"===a.type)return a.city_link_title=pe.link_title_for_city(a.city_name),pe.templatize('<a href="/{{city_id}}" class="border_link" target="_blank" title="{{city_link_title}}">{{city_name}}</a>',a)}).join("/"),a.event_link_title=pe.link_title_for_event(a.title,null),a.photo_text=a.photo_url?pe.templatize('<a href="/events/{{id}}" class="photo ConvertToRoundedCorners float_left" target="_blank" title="{{event_link_title}}"><img src="'+pe.https(pe.assign_photo_size(a.photo_url,"75","75x55"))+
'"></a>',a):"/assets/no_image_75x55.png",pe.templatize('<div class="result_info"><a href="/events/{{id}}" class="headline" title="{{event_link_title}}">{{title}}</a><br>{{photo_text}}<span class="blue_text">Event</span>&nbsp;&nbsp;<span class="grey_text">{{sub_type_text}} / {{location_text}} / {{dates_text}}</span><br><div class="desc">{{description}}<div class="read_more_arrow"><a href="/events/{{id}}" title="{{event_link_title}}" class="float_right"></a> </div></div></div>',a);case "PE Reviewer":return a.link_title=
pe.link_title_for_reviewer(a.title),a.reviewers_link_title=pe.link_title_for_reviewer("All"),a.photo_text=a.photo_url?pe.templatize('<a href="/pe-reviewers/{{id}}" title="{{link_title}}" class="photo ConvertToRoundedCorners float_left" target="_blank"><img src="'+pe.https(pe.assign_photo_size(a.photo_url,"75","75x55"))+'"></a>',a):"/assets/no_image_75x55.png",pe.templatize('<div class="result_info"><a href="/pe-reviewers/{{id}}" class="headline" title="{{link_title}}" target="_blank">{{title}}</a> <br>{{photo_text}}<span class="blue_text">Site Results</span>&nbsp;&nbsp;<span class="grey_text"><a href="/pe-reviewers" title="{{reviewers_link_title}}" target="_blank">PE Reviewers</a></span><br><div class="desc">{{description}}<div class="read_more_arrow"><a href="/pe-reviewers/{{id}}" title="{{link_title}}" class="float_right"></a> </div></div></div>',
a);case "Neighborhood":return a.neighborhood_link_title=pe.link_title_for_neighborhood(a.title,a.city_name),a.city_link_title=pe.link_title_for_city(a.city_name),a.photo_text=a.photo_url?pe.templatize('<a href="/neighborhoods/{{id}}" title="{{neighborhood_link_title}}" class="photo ConvertToRoundedCorners float_left" target="_blank"><img src="'+pe.https(pe.assign_photo_size(a.photo_url,"75","75x55"))+'"></a>',a):"/assets/no_image_75x55.png",pe.templatize('<div class="result_info"><a href="/neighborhoods/{{id}}" title="{{neighborhood_link_title}}" class="headline" target="_blank">{{title}}</a> <br>{{photo_text}}<span class="blue_text">Site Results</span>&nbsp;&nbsp;<span class="grey_text">Neighborhood / <a href="/{{city_id}}" class="border_link" target="_blank" title="{{city_link_title}}">{{city_name}}</a></span><br><div class="desc">{{description}}<div class="read_more_arrow"><a href="/neighborhoods/{{id}}" title="{{neighborhood_link_title}}" class="float_right"></a> </div></div></div>',
a);case "Party Climate":return a.city_link_title=pe.link_title_for_city(a.city_name),a.party_climate_link_title=pe.link_title_for_city_party_climate(a.city_name),a.photo_text=a.photo_url?pe.templatize('<a href="/{{city_id}}/party-climate" class="photo ConvertToRoundedCorners float_left" title="{{party_climate_link_title}}" target="_blank"><img src="'+pe.https(pe.assign_photo_size(a.photo_url,"75","75x55"))+'"></a>',a):"/assets/no_image_75x55.png",pe.templatize('<div class="result_info"><a href="/{{city_id}}/party-climate" class="headline" target="_blank" title="{{party_climate_link_title}}">{{title}}</a> - <a href="/{{city_id}}" target="_blank" title="{{city_link_title}}">{{city_name}}</a><br>{{photo_text}}<span class="blue_text">Site Results</span><br><div class="desc">{{description}}<div class="read_more_arrow"><a href="/{{city_id}}/party-climate" title="{{party_climate_link_title}}" class="float_right"></a> </div></div></div>',
a);case "Overall Impression":return a.city_link_title=pe.link_title_for_city(a.city_name),a.party_climate_link_title=pe.link_title_for_city_party_climate(a.city_name),a.photo_text=a.photo_url?pe.templatize('<a href="/{{city_id}}/party-climate" class="photo ConvertToRoundedCorners float_left"  title="{{party_climate_link_title}}" target="_blank"><img src="'+pe.https(pe.assign_photo_size(a.photo_url,"75","75x55"))+'"></a>',a):"/assets/no_image_75x55.png",pe.templatize('<div class="result_info"><a href="/{{city_id}}/party-climate" title="{{party_climate_link_title}}" class="headline" target="_blank">{{title}}</a> - <a href="/{{city_id}}" class="blue_link" target="_blank" title="{{city_link_title}}">{{city_name}}</a><br>{{photo_text}}<span class="blue_text">Site Results</span><br><div class="desc">{{description}}<div class="read_more_arrow"><a href="/{{city_id}}/party-climate" title="Read full description"    class="float_right" title="{{party_climate_link_title}}"></a> </div></div></div>',
a);case "Page":return a.link_title=pe.templatize("See {{title}}.",a),a.photo_text=a.photo_url?pe.templatize('<a href="/pages/{{id}}" class="photo ConvertToRoundedCorners float_left" target="_blank" title="{{link_title}}"><img src="'+pe.https(pe.assign_photo_size(a.photo_url,"75","75x55"))+'"></a>',a):"/assets/no_image_75x55.png",pe.templatize('<div class="result_info"><a href="/pages/{{id}}" class="headline" target="_blank" title="{{link_title}}">{{title}}</a><br>{{photo_text}}<span class="blue_text">Site Results</span>&nbsp;&nbsp;<div class="desc">{{description}}<div class="read_more_arrow"><a href="/pages/{{id}}" title="{{link_title}}" class="float_right"></a> </div></div></div>',
a);case "City":return a.link_title=pe.link_title_for_city(a.title),a.photo_text=a.photo_url?pe.templatize('<a href="/{{id}}" class="photo ConvertToRoundedCorners float_left" target="_blank" title="{{link_title}}"><img src="'+pe.https(pe.assign_photo_size(a.photo_url,"75","75x55"))+'"></a>',a):"/assets/no_image_75x55.png",pe.templatize('<div class="result_info"><a href="/{{id}}" class="headline" target="_blank" title="{{link_title}}">{{title}}</a><br>{{photo_text}}<span class="grey_text">City</span><br><span class="blue_text">Site Results</span></div>',
a)}};
pe.TextResultFilter=function(a,b){pe.init_widget(this,a);this.container.html(this.html(b));this.results=[];this.search_configuration=null;this.paginator=new pe.Paginator(this.container.find(".Paginator"),null,pe.SearchResultFulltext,10);this.all_button=pe.load(this.container.find(".AllButton"));this.all_button.click(this.callback(this.all_button_clicked));this.all_counter=pe.load(this.container.find(".AllCounter"));this.reviews_button=pe.load(this.container.find(".ReviewsButton"));this.reviews_button.click(this.callback(this.reviews_button_clicked));this.reviews_counter=
pe.load(this.container.find(".ReviewsCounter"));this.events_button=pe.load(this.container.find(".EventsButton"));this.events_button.click(this.callback(this.events_button_clicked));this.events_counter=pe.load(this.container.find(".EventsCounter"));this.performers_button=pe.load(this.container.find(".PerformersButton"));this.performers_button.click(this.callback(this.performer_button_clicked));this.performers_counter=pe.load(this.container.find(".PerformersCounter"));this.other_button=pe.load(this.container.find(".OtherButton"));
this.other_button.click(this.callback(this.other_button_clicked));this.other_counter=pe.load(this.container.find(".OtherCounter"));this.query_label=pe.load(this.container.find(".QueryLabel"))};pe.TextResultFilter.pages={SEARCH_PAGE:1,FULLTEXT_PAGE:2};
pe.TextResultFilter.prototype.all_button_clicked=function(){this.paginator.set_objects(this.results,this.search_configuration);this.all_button.addClass("selected");this.reviews_button.removeClass("selected");this.events_button.removeClass("selected");this.other_button.removeClass("selected");this.performers_button.removeClass("selected")};
pe.TextResultFilter.prototype.events_button_clicked=function(){this.paginator.set_objects(this.get_events(this.results),this.search_configuration);this.all_button.removeClass("selected");this.reviews_button.removeClass("selected");this.events_button.addClass("selected");this.other_button.removeClass("selected");this.performers_button.removeClass("selected")};pe.TextResultFilter.prototype.get_events=function(a){return $.grep(a,function(a){return"Event"===a.result_type})};
pe.TextResultFilter.prototype.get_others=function(a){return $.grep(a,function(a){return-1<"Page,PE Reviewer,Neighborhood,Party Climate,Overall Impression,City".split(",").indexOf(a.result_type)})};pe.TextResultFilter.prototype.get_performers=function(a){return $.grep(a,function(a){return"Performer"===a.result_type})};pe.TextResultFilter.prototype.get_reviews=function(a){return $.grep(a,function(a){return"Venue"===a.result_type})};
pe.TextResultFilter.prototype.html=function(a){var b='<div class="top_message"><span class="query_text">You searched for <strong class="QueryLabel"></strong></span>';a===pe.TextResultFilter.pages.FULLTEXT_PAGE&&(b+='<span>Can\'t find what you are looking for? Try our <a href="/search" class="blue_link">Advanced Search</a>...</span>');return b+'</div><div class="full_text_filters"><span class="found_label">Found: </span><span class="AllButton blue_link fake_link">All Results</span> <span class="grey_text">(<span class="AllCounter"></span>)</span> | <span class="ReviewsButton blue_link fake_link">Reviews</span> <span class="grey_text">(<span class="ReviewsCounter"></span>)</span> | <span class="EventsButton blue_link fake_link">Events</span> <span class="grey_text">(<span class="EventsCounter"></span>)</span> | <span class="PerformersButton blue_link fake_link">Performers/Teams</span> <span class="grey_text">(<span class="PerformersCounter"></span>)</span> | <span class="OtherButton blue_link fake_link">Site results</span> <span class="grey_text">(<span class="OtherCounter"></span>)</span></div><div class="Paginator"></div>'};
pe.TextResultFilter.prototype.other_button_clicked=function(){this.paginator.set_objects(this.get_others(this.results),this.search_configuration);this.all_button.removeClass("selected");this.reviews_button.removeClass("selected");this.events_button.removeClass("selected");this.other_button.addClass("selected");this.performers_button.removeClass("selected")};
pe.TextResultFilter.prototype.performer_button_clicked=function(){this.paginator.set_objects(this.get_performers(this.results),this.search_configuration);this.all_button.removeClass("selected");this.reviews_button.removeClass("selected");this.events_button.removeClass("selected");this.other_button.removeClass("selected");this.performers_button.addClass("selected")};
pe.TextResultFilter.prototype.reviews_button_clicked=function(){this.paginator.set_objects(this.get_reviews(this.results),this.search_configuration);this.all_button.removeClass("selected");this.reviews_button.addClass("selected");this.events_button.removeClass("selected");this.other_button.removeClass("selected");this.performers_button.removeClass("selected")};
pe.TextResultFilter.prototype.set_results=function(a,b){this.results=a;this.query_label.html('"'+unescape(b.get_filter("fulltext"))+'"');this.all_counter.html(this.results.length.toString());this.reviews_counter.html(this.get_reviews(a).length.toString());this.events_counter.html(this.get_events(a).length.toString());this.performers_counter.html(this.get_performers(a).length.toString());this.other_counter.html(this.get_others(a).length.toString());this.all_button_clicked();this.all_button.removeClass("selected")};
