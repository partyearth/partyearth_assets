pe.EventSearcher=function(){pe.init_widget(this,null)};
pe.EventSearcher.prototype.get_matching_events=function(a,c){!a.has_filters("city")||"all"===a.get_filter("city")?c([]):pe.ajax_loader.city_events_on_date_for_map.load({city:a.get_filter("city"),start_date:a.get_filter("start_date_or_default"),end_date:a.get_filter("end_date_or_default")||"",timestamp:pe.events_timestamp()},function(b){b=pe.EventSearcher.filter_by_event_types(b,a);b=pe.EventSearcher.filter_by_result_types(b,a);b=pe.EventSearcher.filter_by_neighborhood(b,a);b=pe.EventSearcher.filter_by_fulltext(b,
a);b=pe.EventSearcher.filter_by_event_name(b,a);b=pe.EventSearcher.filter_by_performer_name(b,a);c(b)})};pe.EventSearcher.filter_by_event_name=function(a,c){var b=c.get_filter("event_name");return!b?a:$.map(a,function(a){if(-1<b.indexOf(a.name))return a})};pe.EventSearcher.filter_by_event_types=function(a,c){var b=c.get_filter("Event Type");return!b||"all"===b?a:$.grep(a,function(a){return pe.array_match(b,a.category)})};
pe.EventSearcher.filter_by_fulltext=function(a,c){var b=c.get_filter("fulltext");return!b?a:$.map(a,function(a){if(pe.text_contains_query(pe.event_search_text(a),b))return a})};pe.EventSearcher.filter_by_neighborhood=function(a,c){var b=c.get_filter("neighborhood");if(!b||"all"===b)return a;$.each(a,function(a,c){c.neighborhood_id&&c.neighborhood_id!==b&&(c.disabled=!0)});return a};
pe.EventSearcher.filter_by_performer_name=function(a,c){var b=c.get_filter("performer_name");return!b||b===[]?a:$.grep(a,function(a){if(!a.performers)return!1;a=$.map(a.performers,function(a){return a.name});return pe.array_match(b,a)})};pe.EventSearcher.filter_by_result_types=function(a,c){var b=c.get_filter("result_types");return!b||-1<b.indexOf("events")?a:[]};
