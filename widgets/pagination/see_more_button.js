pe.SeeMoreButton=function(a,b){pe.init_widget(this,a);this.options={item_container_id:a.attr("rel"),initial_page_number:1,item_class:"Paginable",per_page:16,server_url:"index.ehtml"};$.extend(this.options,b);this.current_page_number=this.options.initial_page_number;this.item_container=$("#"+this.options.item_container_id);this.options.per_page=this.item_container.find("."+this.options.item_class).length||this.options.per_page;this.next_page_content="";this.container.click(this.callback(this.show_next_page));
this.hide();this.load_next_page()};pe.SeeMoreButton.prototype.load_next_page=function(){var a=this.current_page_number+1,b=this.options.per_page,c=pe.assets_timestamp();$.get(this.options.server_url+"?page="+a+"&per_page="+b+"&"+c,null,this.callback(this.set_next_page_content))};pe.SeeMoreButton.prototype.set_next_page_content=function(a){this.next_page_content=a;this.refresh_photo_links();/\S/.test(a)?this.show():this.hide()};
pe.SeeMoreButton.prototype.refresh_photo_links=function(){window.location.href.match(/events/)&&$(".Paginable a").each(function(){var a=pe.fetch_photo_id_from_url($(this).attr("href")+"");$(this).attr("href",window.location+"/"+a)})};pe.SeeMoreButton.prototype.show_next_page=function(){this.item_container.append(this.next_page_content);this.current_page_number+=1;this.load_next_page();return!1};
