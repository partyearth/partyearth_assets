pe.Input=function(a,b){pe.init_widget(this,a);this.options=b;this.options.label||(this.options.label="");this.container.html(this.html(this.options));this.carrier=this.options.carrier||null;this.state=b.initial_state?b.initial_state:pe.Input.states.UNCHECKED;this.update_ui();this.type=b.type;this.click_state=pe.Input.click_states.NOT_PRESSED;this.disabled=!1;this.container.addClass(b.type);this.container.click(this.callback(this.clicked));this.container.mousedown(this.callback(this.mouse_down));this.container.mouseup(this.callback(this.mouse_up))};
pe.Input.events={CHANGED:"Input_CHANGED"};pe.Input.states={CHECKED:"CHECKED",UNCHECKED:"UNCHECKED"};pe.Input.click_states={PRESSED:"PRESSED",NOT_PRESSED:"NOT PRESSED"};pe.Input.types={CHECKBOX:"Checkbox",RADIO_BUTTON:"RadioButton"};pe.Input.prototype.clicked=function(a){this.toggle_checked_status();this.update_ui();a&&a.stopPropagation();this.fire_event(pe.Input.events.CHANGED,this)};pe.Input.prototype.check=function(){this.set_checked(!0)};pe.Input.prototype.disable=function(){this.disabled=!0;this.update_ui()};
pe.Input.prototype.enable=function(){this.disabled=!1;this.update_ui()};pe.Input.prototype.is_checked=function(){return this.state===pe.Input.states.CHECKED};pe.Input.prototype.html=function(a){return pe.templatize('<div class="Input input_selection"></div>{{label}}',a)};pe.Input.prototype.mouse_down=function(){this.click_state=pe.Input.click_states.PRESSED;this.update_ui()};pe.Input.prototype.mouse_up=function(){this.click_state=pe.Input.click_states.NOT_PRESSED;this.update_ui()};
pe.Input.prototype.set_checked=function(a){this.state=a?pe.Input.states.CHECKED:pe.Input.states.UNCHECKED;this.carrier&&this.carrier.attr("checked",a);this.update_ui()};pe.Input.prototype.toggle_checked_status=function(){this.set_checked(!this.is_checked())};pe.Input.prototype.uncheck=function(){this.set_checked(!1)};
pe.Input.prototype.update_ui=function(){this.container.removeClass("checked unchecked checked_pressed unchecked_pressed checked_disabled unchecked_disabled");var a=this.state===pe.Input.states.UNCHECKED?"unchecked":"checked",b=this.disabled?"_disabled":"",e=this.click_state===pe.Input.click_states.PRESSED?"_pressed":"";b&&(e="");this.container.addClass(a+b+e)};
pe.ResultTypeFilter=function(a,b){pe.init_widget(this,a);this.mappable_types=b;this.checkboxes=[];this.container.html($(this.dom()));$.each(this.mappable_types,this.callback(function(a,b){var d=pe.capitalise_first_letter(b),g="Venues"==d?"Reviews":d,f=b+"_checkbox";this[f]=new pe.Input(this.container.find("."+d),{type:pe.Input.types.CHECKBOX,label:g,initial_state:pe.Input.states.CHECKED});this[f].options.mappable_type=b;this[f].bind_event(pe.Input.events.CHANGED,this.callback(this.selection_changed));
this.checkboxes.push(this[f])}))};pe.ResultTypeFilter.events={CHANGED:"ResultTypeFilter_CHANGED"};pe.ResultTypeFilter.prototype.add_search_configuration=function(a){var b=[];$.each(this.checkboxes,function(a,c){var d=c.options.mappable_type;c.is_checked()&&b.push(d)});4!==pe.hash_length(b)&&a.add_filter("result_types",b)};
pe.ResultTypeFilter.prototype.dom=function(){var a="";-1<this.mappable_types.indexOf("events")&&(a+='<li><div id="event_marker" class="map_markers"></div> <div class="Events"></div></li>');-1<this.mappable_types.indexOf("hotspots")&&(a+='<li><div id="hotspot_marker" class="map_markers"></div> <div class="Hotspots"></div></li>');-1<this.mappable_types.indexOf("landmarks")&&(a+='<li><div id="landmark_marker" class="map_markers"></div> <div class="Landmarks"></div></li>');-1<this.mappable_types.indexOf("venues")&&
(a+='<li><div id="venue_marker" class="map_markers"></div> <div class="Venues"></div></li>');return"<ul>"+a+"</ul>"};pe.ResultTypeFilter.prototype.fix_checkbox=function(a){$.each(this.checkboxes,function(a,e){e.enable()});a.check();a.disable()};pe.ResultTypeFilter.prototype.read_search_configuration=function(a){var b=a.get_filter("result_types");b&&$.each(this.checkboxes,function(a,c){c.set_checked(-1<b.indexOf(c.options.mappable_type))})};
pe.ResultTypeFilter.prototype.reset=function(){$.each(this.checkboxes,function(a,b){b.check()})};pe.ResultTypeFilter.prototype.selection_changed=function(){this.fire_event(pe.ResultTypeFilter.events.CHANGED)};pe.ResultTypeFilter.prototype.set_selected_tab=function(a){this.fix_checkbox(this[a.toLowerCase()+"_checkbox"])};
