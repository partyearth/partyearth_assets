!function(P){function k(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null==i?"":i[1]}P.prettyPhoto={version:"3.0"},P.fn.prettyPhoto=function(p){function o(e){$pp_pic_holder.find("#pp_full_res object,#pp_full_res embed").css("visibility","hidden"),$pp_pic_holder.find(".pp_fade").fadeOut(settings.animation_speed,function(){P(".pp_loaderIcon").show(),e()})}function a(e){set_position==e-1?($pp_pic_holder.find("a.pp_next").css("visibility","hidden"),$pp_pic_holder.find("a.pp_next").addClass("disabled").unbind("click")):($pp_pic_holder.find("a.pp_next").css("visibility","visible"),$pp_pic_holder.find("a.pp_next.disabled").removeClass("disabled").bind("click",function(){return P.prettyPhoto.changePage("next"),!1})),0==set_position?$pp_pic_holder.find("a.pp_previous").css("visibility","hidden").addClass("disabled").unbind("click"):$pp_pic_holder.find("a.pp_previous.disabled").css("visibility","visible").removeClass("disabled").bind("click",function(){return P.prettyPhoto.changePage("previous"),!1}),1<e?P(".pp_nav").show():P(".pp_nav").hide()}function s(e,t){if(resized=!1,i(e,t),imageWidth=e,imageHeight=t,(b<u||w<m)&&doresize&&settings.allow_resize&&!y){for(resized=!0,fitting=!1;!fitting;)b<u?(imageWidth=b-200,imageHeight=t/e*imageWidth):w<m?(imageHeight=w-200,imageWidth=e/t*imageHeight):fitting=!0,m=imageHeight,u=imageWidth;i(imageWidth,imageHeight)}return{width:Math.floor(imageWidth),height:Math.floor(imageHeight),containerHeight:Math.floor(m),containerWidth:Math.floor(u)+40,contentHeight:Math.floor(_),contentWidth:Math.floor(g),resized:resized}}function i(e,t){e=parseFloat(e),t=parseFloat(t),$pp_details=$pp_pic_holder.find(".pp_details"),$pp_details.width(e),detailsHeight=parseFloat($pp_details.css("marginTop"))+parseFloat($pp_details.css("marginBottom")),$pp_details=$pp_details.clone().appendTo(P("body")).css({position:"absolute",top:-1e4}),detailsHeight+=$pp_details.height(),detailsHeight=detailsHeight<=34?36:detailsHeight,P.browser.msie&&7==P.browser.version&&(detailsHeight+=8),$pp_details.remove(),_=t+detailsHeight,g=e,m=_+$ppt.height()+$pp_pic_holder.find(".pp_top").height()+$pp_pic_holder.find(".pp_bottom").height(),u=e}function r(e){return e.match(/youtube\.com\/watch/i)?"youtube":e.match(/vimeo\.com/i)?"vimeo":-1!=e.indexOf(".mov")?"quicktime":-1!=e.indexOf(".swf")?"flash":-1!=e.indexOf("iframe")?"iframe":-1!=e.indexOf("custom")?"custom":"#"==e.substr(0,1)?"inline":"image"}function n(){doresize&&"undefined"!=typeof $pp_pic_holder&&(scroll_pos=e(),titleHeight=$ppt.height(),contentHeight=$pp_pic_holder.height(),contentwidth=$pp_pic_holder.width(),projectedTop=w/2+scroll_pos.scrollTop-contentHeight/2,$pp_pic_holder.css({top:projectedTop,left:b/2+scroll_pos.scrollLeft-contentwidth/2}))}function e(){return self.pageYOffset?{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset}:document.documentElement&&document.documentElement.scrollTop?{scrollTop:document.documentElement.scrollTop,scrollLeft:document.documentElement.scrollLeft}:document.body?{scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft}:void 0}function t(){w=P(window).height(),b=P(window).width(),"undefined"!=typeof $pp_overlay&&$pp_overlay.height(P(document).height())}function l(){isSet&&settings.overlay_gallery&&"image"==r(pp_images[set_position])?(itemWidth=57,navWidth="facebook"==settings.theme?58:38,itemsPerPage=Math.floor((c.containerWidth-100-navWidth)/itemWidth),itemsPerPage=itemsPerPage<pp_images.length?itemsPerPage:pp_images.length,totalPage=Math.ceil(pp_images.length/itemsPerPage)-1,0==totalPage?(navWidth=0,$pp_pic_holder.find(".pp_gallery .pp_arrow_next,.pp_gallery .pp_arrow_previous").hide()):$pp_pic_holder.find(".pp_gallery .pp_arrow_next,.pp_gallery .pp_arrow_previous").show(),galleryWidth=itemsPerPage*itemWidth+navWidth,$pp_pic_holder.find(".pp_gallery").width(galleryWidth).css("margin-left",-galleryWidth/2),$pp_pic_holder.find(".pp_gallery ul").width(itemsPerPage*itemWidth).find("li.selected").removeClass("selected"),goToPage=Math.floor(set_position/itemsPerPage)<=totalPage?Math.floor(set_position/itemsPerPage):totalPage,itemsPerPage?$pp_pic_holder.find(".pp_gallery").hide().show().removeClass("disabled"):$pp_pic_holder.find(".pp_gallery").hide().addClass("disabled"),P.prettyPhoto.changeGalleryPage(goToPage),$pp_pic_holder.find(".pp_gallery ul li:eq("+set_position+")").addClass("selected")):($pp_pic_holder.find(".pp_content").unbind("mouseenter mouseleave"),$pp_pic_holder.find(".pp_gallery").hide())}function d(e){if(theRel=P(e).attr("rel"),galleryRegExp=/\[(?:.*)\]/,isSet=!!galleryRegExp.exec(theRel),pp_images=isSet?jQuery.map(v,function(e){if(-1!=P(e).attr("rel").indexOf(theRel))return P(e).attr("href")}):P.makeArray(P(e).attr("href")),pp_titles=isSet?jQuery.map(v,function(e){if(-1!=P(e).attr("rel").indexOf(theRel))return P(e).find("img").attr("alt")?P(e).find("img").attr("alt"):""}):P.makeArray(P(e).find("img").attr("alt")),pp_descriptions=isSet?jQuery.map(v,function(e){if(-1!=P(e).attr("rel").indexOf(theRel))return P(e).attr("title")?P(e).attr("title"):""}):P.makeArray(P(e).attr("title")),P("body").append(settings.markup),$pp_pic_holder=P(".pp_pic_holder"),$ppt=P(".ppt"),$pp_overlay=P("div.pp_overlay"),isSet&&settings.overlay_gallery){currentGalleryPage=0,toInject="";for(var t=0;t<pp_images.length;t++){var i=new RegExp("(.*?).(jpg|jpeg|png|gif)$").exec(pp_images[t]);classname=i?"":"default",toInject+="<li class='"+classname+"'><a href='#'><img src='"+pp_images[t]+"' width='50' alt='' /></a></li>"}toInject=settings.gallery_markup.replace(/{gallery}/g,toInject),$pp_pic_holder.find("#pp_full_res").after(toInject),$pp_pic_holder.find(".pp_gallery .pp_arrow_next").click(function(){return P.prettyPhoto.changeGalleryPage("next"),P.prettyPhoto.stopSlideshow(),!1}),$pp_pic_holder.find(".pp_gallery .pp_arrow_previous").click(function(){return P.prettyPhoto.changeGalleryPage("previous"),P.prettyPhoto.stopSlideshow(),!1}),$pp_pic_holder.find(".pp_content").hover(function(){$pp_pic_holder.find(".pp_gallery:not(.disabled)").fadeIn()},function(){$pp_pic_holder.find(".pp_gallery:not(.disabled)").fadeOut()}),itemWidth=57,$pp_pic_holder.find(".pp_gallery ul li").each(function(e){P(this).css({position:"absolute",left:e*itemWidth}),P(this).find("a").unbind("click").click(function(){return P.prettyPhoto.changePage(e),P.prettyPhoto.stopSlideshow(),!1})})}settings.slideshow&&($pp_pic_holder.find(".pp_nav").prepend('<a href="#" class="pp_play">Play</a>'),$pp_pic_holder.find(".pp_nav .pp_play").click(function(){return P.prettyPhoto.startSlideshow(),!1})),$pp_pic_holder.attr("class","pp_pic_holder "+settings.theme),$pp_overlay.css({opacity:0,height:P(document).height(),width:P(document).width()}).bind("click",function(){settings.modal||P.prettyPhoto.close()}),P("a.pp_close").bind("click",function(){return P.prettyPhoto.close(),!1}),P("a.pp_expand").bind("click",function(){return P(this).hasClass("pp_expand")?(P(this).removeClass("pp_expand").addClass("pp_contract"),doresize=!1):(P(this).removeClass("pp_contract").addClass("pp_expand"),doresize=!0),o(function(){P.prettyPhoto.open()}),!1}),$pp_pic_holder.find(".pp_previous, .pp_nav .pp_arrow_previous").bind("click",function(){return P.prettyPhoto.changePage("previous"),P.prettyPhoto.stopSlideshow(),!1}),$pp_pic_holder.find(".pp_next, .pp_nav .pp_arrow_next").bind("click",function(){return P.prettyPhoto.changePage("next"),P.prettyPhoto.stopSlideshow(),!1}),n()}p=jQuery.extend({animation_speed:"fast",slideshow:!1,autoplay_slideshow:!1,opacity:.8,show_title:!0,allow_resize:!0,default_width:500,default_height:344,counter_separator_label:"/",theme:"facebook",hideflash:!1,wmode:"opaque",autoplay:!0,modal:!1,overlay_gallery:!0,keyboard_shortcuts:!0,changepicturecallback:function(){},callback:function(){},markup:'<div class="pp_pic_holder">       <div class="ppt">&nbsp;</div>       <div class="pp_top">        <div class="pp_left"></div>        <div class="pp_middle"></div>        <div class="pp_right"></div>       </div>       <div class="pp_content_container">        <div class="pp_left">        <div class="pp_right">         <div class="pp_content">          <div class="pp_loaderIcon"></div>          <div class="pp_fade">           <a href="#" class="pp_expand" title="Expand the image">Expand</a>           <div class="pp_hoverContainer">            <a class="pp_next" href="#">next</a>            <a class="pp_previous" href="#">previous</a>           </div>           <div id="pp_full_res"></div>           <div class="pp_details clearfix">            <p class="pp_description"></p>            <a class="pp_close" href="#">Close</a>            <div class="pp_nav">             <a href="#" class="pp_arrow_previous">Previous</a>             <p class="currentTextHolder">0/0</p>             <a href="#" class="pp_arrow_next">Next</a>            </div>           </div>          </div>         </div>        </div>        </div>       </div>       <div class="pp_bottom">        <div class="pp_left"></div>        <div class="pp_middle"></div>        <div class="pp_right"></div>       </div>      </div>      <div class="pp_overlay"></div>',gallery_markup:'<div class="pp_gallery">         <a href="#" class="pp_arrow_previous">Previous</a>         <ul>          {gallery}         </ul>         <a href="#" class="pp_arrow_next">Next</a>        </div>',image_markup:'<img id="fullResImage" src="" />',flash_markup:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{path}" /><embed src="{path}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',quicktime_markup:'<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" height="{height}" width="{width}"><param name="src" value="{path}"><param name="autoplay" value="{autoplay}"><param name="type" value="video/quicktime"><embed src="{path}" height="{height}" width="{width}" autoplay="{autoplay}" type="video/quicktime" pluginspage="http://www.apple.com/quicktime/download/"></embed></object>',iframe_markup:'<iframe src ="{path}" width="{width}" height="{height}" frameborder="no"></iframe>',inline_markup:'<div class="pp_inline clearfix">{content}</div>',custom_markup:""},p);var c,h,_,g,m,u,f,v=this,y=!1,w=P(window).height(),b=P(window).width();return doresize=!0,scroll_pos=e(),P(window).unbind("resize").resize(function(){n(),t()}),p.keyboard_shortcuts&&P(document).unbind("keydown").keydown(function(e){if("undefined"!=typeof $pp_pic_holder&&$pp_pic_holder.is(":visible")){switch(e.keyCode){case 37:P.prettyPhoto.changePage("previous");break;case 39:P.prettyPhoto.changePage("next");break;case 27:settings.modal||P.prettyPhoto.close()}return!1}}),P.prettyPhoto.initialize=function(){return settings=p,P.browser.msie&&6==parseInt(P.browser.version)&&(settings.theme="light_square"),d(this),settings.allow_resize&&P(window).scroll(function(){n()}),n(),set_position=jQuery.inArray(P(this).attr("href"),pp_images),P.prettyPhoto.open(),!1},P.prettyPhoto.open=function(e,t,i){return"undefined"==typeof settings&&(settings=p,P.browser.msie&&6==P.browser.version&&(settings.theme="light_square"),d(e.target),pp_images=P.makeArray(e),pp_titles=t?P.makeArray(t):P.makeArray(""),pp_descriptions=i?P.makeArray(i):P.makeArray(""),isSet=1<pp_images.length,set_position=0),P.browser.msie&&6==P.browser.version&&P("select").css("visibility","hidden"),settings.hideflash&&P("object,embed").css("visibility","hidden"),a(P(pp_images).size()),P(".pp_loaderIcon").show(),$ppt.is(":hidden")&&$ppt.css("opacity",0).show(),$pp_overlay.show().fadeTo(settings.animation_speed,settings.opacity),$pp_pic_holder.find(".currentTextHolder").text(set_position+1+settings.counter_separator_label+P(pp_images).size()),$pp_pic_holder.find(".pp_description").show().html(unescape(pp_descriptions[set_position])),settings.show_title&&""!=pp_titles[set_position]&&"undefined"!=typeof pp_titles[set_position]?$ppt.html(unescape(pp_titles[set_position])):$ppt.html("&nbsp;"),movie_width=parseFloat(k("width",pp_images[set_position]))?k("width",pp_images[set_position]):settings.default_width.toString(),movie_height=parseFloat(k("height",pp_images[set_position]))?k("height",pp_images[set_position]):settings.default_height.toString(),-1!=movie_width.indexOf("%")||-1!=movie_height.indexOf("%")?(movie_height=parseFloat(P(window).height()*parseFloat(movie_height)/100-150),movie_width=parseFloat(P(window).width()*parseFloat(movie_width)/100-150),y=!0):y=!1,$pp_pic_holder.fadeIn(function(){switch(imgPreloader="",r(pp_images[set_position])){case"image":imgPreloader=new Image,nextImage=new Image,isSet&&set_position>P(pp_images).size()&&(nextImage.src=pp_images[set_position+1]),prevImage=new Image,isSet&&pp_images[set_position-1]&&(prevImage.src=pp_images[set_position-1]),$pp_pic_holder.find("#pp_full_res")[0].innerHTML=settings.image_markup,$pp_pic_holder.find("#fullResImage").attr("src",pp_images[set_position]),imgPreloader.onload=function(){c=s(imgPreloader.width,imgPreloader.height),_showContent()},imgPreloader.onerror=function(){alert("Image cannot be loaded. Make sure the path is correct and image exist."),P.prettyPhoto.close()},imgPreloader.src=pp_images[set_position];break;case"youtube":c=s(movie_width,movie_height),movie="http://www.youtube.com/v/"+k("v",pp_images[set_position]),settings.autoplay&&(movie+="&autoplay=1"),toInject=settings.flash_markup.replace(/{width}/g,c.width).replace(/{height}/g,c.height).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,movie);break;case"vimeo":c=s(movie_width,movie_height),movie_id=pp_images[set_position];var e=/http:\/\/(www\.)?vimeo.com\/(\d+)/,t=movie_id.match(e);movie="http://player.vimeo.com/video/"+t[2]+"?title=0&amp;byline=0&amp;portrait=0",settings.autoplay&&(movie+="&autoplay=1;"),vimeo_width=c.width+"/embed/?moog_width="+c.width,toInject=settings.iframe_markup.replace(/{width}/g,vimeo_width).replace(/{height}/g,c.height).replace(/{path}/g,movie);break;case"quicktime":(c=s(movie_width,movie_height)).height+=15,c.contentHeight+=15,c.containerHeight+=15,toInject=settings.quicktime_markup.replace(/{width}/g,c.width).replace(/{height}/g,c.height).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,pp_images[set_position]).replace(/{autoplay}/g,settings.autoplay);break;case"flash":c=s(movie_width,movie_height),flash_vars=pp_images[set_position],flash_vars=flash_vars.substring(pp_images[set_position].indexOf("flashvars")+10,pp_images[set_position].length),filename=pp_images[set_position],filename=filename.substring(0,filename.indexOf("?")),toInject=settings.flash_markup.replace(/{width}/g,c.width).replace(/{height}/g,c.height).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,filename+"?"+flash_vars);break;case"iframe":c=s(movie_width,movie_height),frame_url=pp_images[set_position],frame_url=frame_url.substr(0,frame_url.indexOf("iframe")-1),toInject=settings.iframe_markup.replace(/{width}/g,c.width).replace(/{height}/g,c.height).replace(/{path}/g,frame_url);break;case"custom":c=s(movie_width,movie_height),toInject=settings.custom_markup;break;case"inline":myClone=P(pp_images[set_position]).clone().css({width:settings.default_width}).wrapInner('<div id="pp_full_res"><div class="pp_inline clearfix"></div></div>').appendTo(P("body")),c=s(P(myClone).width(),P(myClone).height()),P(myClone).remove(),toInject=settings.inline_markup.replace(/{content}/g,P(pp_images[set_position]).html())}imgPreloader||($pp_pic_holder.find("#pp_full_res")[0].innerHTML=toInject,_showContent())}),!1},P.prettyPhoto.changePage=function(e){if(currentGalleryPage=0,"previous"==e){if(set_position--,set_position<0)return void(set_position=0)}else"next"==e?(set_position++,set_position>P(pp_images).size()-1&&(set_position=0)):set_position=e;doresize||(doresize=!0),P(".pp_contract").removeClass("pp_contract").addClass("pp_expand"),o(function(){P.prettyPhoto.open()})},P.prettyPhoto.changeGalleryPage=function(e){"next"==e?(currentGalleryPage++,currentGalleryPage>totalPage&&(currentGalleryPage=0)):"previous"==e?(currentGalleryPage--,currentGalleryPage<0&&(currentGalleryPage=totalPage)):currentGalleryPage=e,itemsToSlide=currentGalleryPage==totalPage?pp_images.length-totalPage*itemsPerPage:itemsPerPage,$pp_pic_holder.find(".pp_gallery li").each(function(e){P(this).animate({left:e*itemWidth-itemsToSlide*itemWidth*currentGalleryPage})})},P.prettyPhoto.startSlideshow=function(){void 0===f?($pp_pic_holder.find(".pp_play").unbind("click").removeClass("pp_play").addClass("pp_pause").click(function(){return P.prettyPhoto.stopSlideshow(),!1}),f=setInterval(P.prettyPhoto.startSlideshow,settings.slideshow)):P.prettyPhoto.changePage("next")},P.prettyPhoto.stopSlideshow=function(){$pp_pic_holder.find(".pp_pause").unbind("click").removeClass("pp_pause").addClass("pp_play").click(function(){return P.prettyPhoto.startSlideshow(),!1}),clearInterval(f),f=undefined},P.prettyPhoto.close=function(){clearInterval(f),$pp_pic_holder.stop().find("object,embed").css("visibility","hidden"),P("div.pp_pic_holder,div.ppt,.pp_fade").fadeOut(settings.animation_speed,function(){P(this).remove()}),$pp_overlay.fadeOut(settings.animation_speed,function(){P.browser.msie&&6==P.browser.version&&P("select").css("visibility","visible"),settings.hideflash&&P("object,embed").css("visibility","visible"),P(this).remove(),P(window).unbind("scroll"),settings.callback(),doresize=!0,h=!1,delete settings})},_showContent=function(){P(".pp_loaderIcon").hide(),$ppt.fadeTo(settings.animation_speed,1),projectedTop=scroll_pos.scrollTop+(w/2-c.containerHeight/2),projectedTop<0&&(projectedTop=0),$pp_pic_holder.find(".pp_content").animate({height:c.contentHeight},settings.animation_speed),$pp_pic_holder.animate({top:projectedTop,left:b/2-c.containerWidth/2,width:c.containerWidth},settings.animation_speed,function(){$pp_pic_holder.find(".pp_hoverContainer,#fullResImage").height(c.height).width(c.width),$pp_pic_holder.find(".pp_fade").fadeIn(settings.animation_speed),isSet&&"image"==r(pp_images[set_position])?$pp_pic_holder.find(".pp_hoverContainer").show():$pp_pic_holder.find(".pp_hoverContainer").hide(),c.resized&&P("a.pp_expand,a.pp_contract").fadeIn(settings.animation_speed),!settings.autoplay_slideshow||f||h||P.prettyPhoto.startSlideshow(),settings.changepicturecallback(),h=!0}),l()},this.unbind("click").click(P.prettyPhoto.initialize)}}(jQuery),$(document).ready(function(){pe.photos=$(".Gallery a[rel^='prettyPhoto']"),pe.photos.prettyPhoto({theme:"dark_rounded",animationSpeed:"fast",overlay_gallery:!1}),$(".Steps").click(pe.step_link_clicked),pe.init_page_framework()}),pe.step_link_clicked=function(e){e.stopImmediatePropagation();var t=$(e.target).data("step");return t?$(pe.photos[t-1]).click():$(pe.photos[0]).click(),!1};