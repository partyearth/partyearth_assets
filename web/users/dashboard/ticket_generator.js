(function(){var c=function(d,a){return function(){return d.apply(a,arguments)}},e=pe,a=function(a){var b=this;this.container=a;this.update_image_style=c(this.update_image_style,this);this.update_text=c(this.update_text,this);this.update_color=c(this.update_color,this);this.update_size=c(this.update_size,this);this.reset=c(this.reset,this);this.generate=c(this.generate,this);this.disabled=!1;this.image_selector=this.container.find(".ImageSelector");this.button_text_toggler=this.container.find(".ButtonTextToggler");
this.button_text_input=this.container.find(".ButtonTextInput");this.size_input=this.container.find(".SizeInput");this.generate_button=this.container.find(".GenerateButton");this.debug_container=this.container.find(".DebugContainer");this.code_container=this.container.find(".CodeContainer");this.preview=this.container.find(".Preview");this.reset_button=this.container.find(".ResetButton");this.color_container=this.container.find(".ColorInput");this.button_text_toggler.change(this.update_text);this.button_text_input.keydown(this.update_text);
this.button_text_input.keyup(this.update_text);this.size_input.change(this.update_size);this.image_selector.change(this.update_image_style);this.color_container.change(this.update_color);this.generate_button.click(this.generate);this.reset_button.click(this.reset);this.button_text_toggler.change(function(){if(!b.default_text_selected())return b.button_text_input.focus()});this.container.find("input").change(function(){return b.code_container.css("opacity",0.5)});this.update_size();this.update_text();
this.update_image_style();this.code_container.css("opacity",0.5);this.default_state=this.serialize()};a.prototype.generate=function(){var a=this;if(!this.disabled)return this.generate_button.html("Please wait..."),this.generate_button.css("opacity",0.5),this.generate_button.css("cursor","wait"),pe.routes.Request.from_current_location("generate_button_user_dashboard_event",this.serialize()).get(function(b){a.generate_button.html("Generate");a.generate_button.css("cursor","pointer");a.generate_button.css("opacity",
1);a.disabled=!1;a.debug_container.html(b);a.code_container.val(b);return a.code_container.css("opacity",1)}),this.disabled=!0};a.prototype.serialize=function(){return{height:this.height()||this.actual_height(),width:this.width()||this.actual_width(),outer_width:this.actual_width(),outer_height:this.actual_height(),text:this.text(),style:this.style(),image_style:this.image_style(),color:this.color()}};a.prototype.reset=function(){if(confirm("Are you sure you want to reset the button back to its default settings?"))return this.button_text_toggler.filter(":first").click(),
this.size_input.filter(":last").click(),this.image_selector.filter(":first").click(),this.button_text_input.val(""),this.code_container.val("")};a.prototype.image_style=function(){return this.image_selector.filter(":checked").val()};a.prototype.size=function(){return this.size_input.filter(":checked").data()};a.prototype.width=function(){return this.size().width};a.prototype.height=function(){return this.size().height};a.prototype.style=function(){return this.size().style};a.prototype.color=function(){return this.color_container.filter(":checked").val()};
a.prototype.actual_width=function(){return this.preview.outerWidth()};a.prototype.actual_height=function(){return this.preview.outerHeight()};a.prototype.update_size=function(){var a=this;this.preview.css("width",this.width()+"px");this.preview.css("height",this.height()+"px");_.each(this.size_input,function(b){return a.preview.removeClass($(b).data().style)});return this.preview.addClass(this.style())};a.prototype.update_color=function(){var a=this;_.each(this.color_container,function(b){return a.preview.removeClass($(b).val())});
return this.preview.addClass(this.color())};a.prototype.update_text=function(a){if(25>=this.text().length)return this.preview.find(".Text").html(this.text());this.button_text_input.val(this.text().substring(0,25));a.preventDefault();return a.stopPropagation()};a.prototype.update_image_style=function(){var a=this;_.each(this.image_selector,function(b){return a.preview.removeClass($(b).val())});return this.preview.addClass(this.image_style())};a.prototype.default_text_selected=function(){return"Buy Tickets"===
this.button_text_toggler.filter(":checked").val()};a.prototype.text=function(){return this.default_text_selected()?"Buy Tickets":this.button_text_input.val().replace(/<\/?[^>]+(>|$)/g,"")||"Buy Tickets"};e.TicketButtonGenerator=a}).call(this);
