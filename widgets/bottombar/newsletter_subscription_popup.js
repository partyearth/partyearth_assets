pe.BottombarNewsletterSubscriptionPopup=function(a){pe.init_widget(this,a);this.bottombar_popup_module=new pe.BottombarPopupModule(this.container,"NewsletterPopup",500,200,"Subscribe to our Newsletter",this.html());this.bottombar_popup_module.container.addClass("popup newsletter_popup");this.email_input=this.bottombar_popup_module.container.find(".Email");pe.validate_on_blur(this.email_input,pe.validation.ensure_email_not_blank_and_is_valid);this.submit_button=this.bottombar_popup_module.container.find(".Submit");
this.submit_button.click(this.callback(this.submit_button_clicked))};pe.BottombarNewsletterSubscriptionPopup.prototype.html=function(){return'<div class="field_item">  <label for="YourEmail">Your E-mail <span class="blue_text">*</span></label>  <input id="YourEmail" data_label="Email" class="Email" type="text"></div>  <div class="Submit btn submit_btn float_right">Submit</div>'};
pe.BottombarNewsletterSubscriptionPopup.prototype.submit_button_clicked=function(){if(this.validate_on_submit())$.ajax({url:"/subscriptions/subscribe.json",data:{email:this.email_input.val(),newsletter_type_id:10},type:"POST",success:this.callback(function(a){this.form_submitted(a)})});else return this.email_input.focus(),!1};
pe.BottombarNewsletterSubscriptionPopup.prototype.form_submitted=function(a){if(1===a.message)this.bottombar_popup_module.show_thank_you("Thank you for subscribing with Party Earth!");else return this.submit_button.before('<p class="inline-errors">'+a.message+"</p>"),!1};pe.BottombarNewsletterSubscriptionPopup.prototype.validate_on_submit=function(){pe.validation.clear_error_messages(this.bottombar_popup_module.container);this.email_input.data("text_entered",!0).blur();return 0===this.bottombar_popup_module.container.find(".inline-errors").length};
