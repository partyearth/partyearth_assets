pe.CalendarOverlay=function(a,b){pe.init_widget(this,$(this.html()));a.append(this.container);this.start_configuration=b.current_search_configuration();this.date_picker=this.container.find(".DatePicker");this.date_picker.datepicker({numberOfMonths:2,onSelect:this.callback(this.date_selected)});this.selected_dates_title_div=$(".SelectedDates");new pe.CloseButton(this.container,pe.CloseButton.close_methods.HIDE)};pe.CalendarOverlay.events={CHANGED:"CityMap_CalendarSelect_CHANGED"};
pe.CalendarOverlay.prototype.add_search_configuration=function(a){var b=this.get_selected_date();b&&(b=pe.format_date(b),a.add_filter("start_date",b),a.add_filter("end_date",b))};pe.CalendarOverlay.prototype.date_selected=function(){this.date_picker.datepicker("hide");this.container.hide();this.set_selected_dates_title();this.fire_event(pe.CalendarOverlay.events.CHANGED)};pe.CalendarOverlay.prototype.get_selected_date=function(){return this.date_picker.datepicker("getDate")};
pe.CalendarOverlay.prototype.html=function(){return'<div class="overlay"><div class="headline">Select a Date</div><div class="DatePicker"></div><div class="fake_link CloseButton"></div><div id="calendar_arrow" class="overlay_arrow"></div> </div>'};pe.CalendarOverlay.prototype.set_selected_dates_title=function(){if(!this.selected_dates_title_div)return null;this.selected_dates_title_div.html(this.selected_dates_title_html())};
pe.CalendarOverlay.prototype.selected_dates_title_html=function(){var a=this.get_selected_date();return!a?$.datepicker.formatDate("DD M d",new Date):$.datepicker.formatDate("DD M d",new Date(a))};
