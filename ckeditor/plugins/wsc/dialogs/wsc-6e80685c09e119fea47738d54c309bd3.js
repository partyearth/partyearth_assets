CKEDITOR.dialog.add("checkspell",function(a){function c(c,b){var e=0;return function(){if("function"==typeof window.doSpell){"undefined"!=typeof f&&window.clearInterval(f);var g=new window._SP_FCK_LangCompare,h=CKEDITOR.getUrl(a.plugins.wsc.path+"dialogs/"),l=h+"tmpFrameset.html";window.gFCKPluginName="wsc";g.setDefaulLangCode(a.config.defaultLanguage);window.doSpell({ctrl:j,lang:a.config.wsc_lang||g.getSPLangCode(a.langCode),intLang:a.config.wsc_uiLang||g.getSPLangCode(a.langCode),winType:d,onCancel:function(){c.hide()},
onFinish:function(b){a.focus();c.getParentEditor().setData(b.value);c.hide()},staticFrame:l,framesetPath:l,iframePath:h+"ciframe.html",schemaURI:h+"wsc.css",userDictionaryName:a.config.wsc_userDictionaryName,customDictionaryName:a.config.wsc_customDictionaryIds&&a.config.wsc_customDictionaryIds.split(","),domainName:a.config.wsc_domainName});CKEDITOR.document.getById(k).setStyle("display","none");CKEDITOR.document.getById(d).setStyle("display","block")}else 180==e++&&window._cancelOnError(b)}}var b=
CKEDITOR.tools.getNextNumber(),d="cke_frame_"+b,j="cke_data_"+b,k="cke_error_"+b,f,b=document.location.protocol||"http:",e=a.lang.spellCheck.notAvailable,m='<textarea style="display: none" id="'+j+'" rows="10" cols="40"> </textarea><div id="'+k+'" style="display:none;color:red;font-size:16px;font-weight:bold;padding-top:160px;text-align:center;z-index:11;"></div><iframe src="" style="width:100%;background-color:#f1f1e3;" frameborder="0" name="'+d+'" id="'+d+'" allowtransparency="1"></iframe>',n=a.config.wsc_customLoaderScript||
b+"//loader.webspellchecker.net/sproxy_fck/sproxy.php?plugin=fck2&customerid="+a.config.wsc_customerId+"&cmd=script&doc=wsc&schema=22";a.config.wsc_customLoaderScript&&(e+='<p style="color:#000;font-size:11px;font-weight: normal;text-align:center;padding-top:10px">'+a.lang.spellCheck.errorLoading.replace(/%s/g,a.config.wsc_customLoaderScript)+"</p>");window._cancelOnError=function(c){if("undefined"==typeof window.WSC_Error){CKEDITOR.document.getById(d).setStyle("display","none");var b=CKEDITOR.document.getById(k);
b.setStyle("display","block");b.setHtml(c||a.lang.spellCheck.notAvailable)}};return{title:a.config.wsc_dialogTitle||a.lang.spellCheck.title,minWidth:485,minHeight:380,buttons:[CKEDITOR.dialog.cancelButton],onShow:function(){var b=this.getContentElement("general","content").getElement();b.setHtml(m);b.getChild(2).setStyle("height",this._.contentSize.height+"px");"function"!=typeof window.doSpell&&CKEDITOR.document.getHead().append(CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript",
src:n}}));b=a.getData();CKEDITOR.document.getById(j).setValue(b);f=window.setInterval(c(this,e),250)},onHide:function(){window.ooo=void 0;window.int_framsetLoaded=void 0;window.framesetLoaded=void 0;window.is_window_opened=!1},contents:[{id:"general",label:a.config.wsc_dialogTitle||a.lang.spellCheck.title,padding:0,elements:[{type:"html",id:"content",html:""}]}]}});
CKEDITOR.dialog.on("resize",function(a){a=a.data;var c=a.dialog;"checkspell"==c._.name&&((c=(c=c.getContentElement("general","content").getElement())&&c.getChild(2))&&c.setSize("height",a.height),c&&c.setSize("width",a.width))});
