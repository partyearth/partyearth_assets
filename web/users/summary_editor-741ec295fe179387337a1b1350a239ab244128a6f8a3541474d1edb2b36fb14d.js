!function($){$.fn.editable=function(t,e){if("disable"!=t)if("enable"!=t){if("destroy"!=t){var u=$.extend({},$.fn.editable.defaults,{target:t},e),d=$.editable.types[u.type].plugin||function(){},c=$.editable.types[u.type].submit||function(){},p=$.editable.types[u.type].buttons||$.editable.types.defaults.buttons,h=$.editable.types[u.type].content||$.editable.types.defaults.content,m=$.editable.types[u.type].element||$.editable.types.defaults.element,y=$.editable.types[u.type].reset||$.editable.types.defaults.reset,f=u.callback||function(){},b=u.onedit||function(){},v=u.onsubmit||function(){},i=u.onreset||function(){},_=u.onerror||y;return u.tooltip&&$(this).attr("title",u.tooltip),u.autowidth="auto"==u.width,u.autoheight="auto"==u.height,this.each(function(){var l=this,a=$(l).width(),o=$(l).height();$(this).data("event.editable",u.event),$.trim($(this).html())||$(this).html(u.placeholder),$(this).bind(u.event,function(t){if(!0!==$(this).data("disabled.editable")&&!l.editing&&!1!==b.apply(this,[u,l])){t.preventDefault(),t.stopPropagation(),u.tooltip&&$(l).removeAttr("title"),0==$(l).width()?(u.width=a,u.height=o):("none"!=u.width&&(u.width=u.autowidth?$(l).width():u.width),"none"!=u.height&&(u.height=u.autoheight?$(l).height():u.height)),$(this).html().toLowerCase().replace(/(;|")/g,"")==u.placeholder.toLowerCase().replace(/(;|")/g,"")&&$(this).html(""),l.editing=!0,l.revert=$(l).html(),$(l).html("");var n=$("<form />");u.cssclass&&("inherit"==u.cssclass?n.attr("class",$(l).attr("class")):n.attr("class",u.cssclass)),u.style&&("inherit"==u.style?(n.attr("style",$(l).attr("style")),n.css("display",$(l).css("display"))):n.attr("style",u.style));var e,s=m.apply(n,[u,l]);if(u.loadurl){var r=setTimeout(function(){s.disabled=!0,h.apply(n,[u.loadtext,u,l])},100),i={};i[u.id]=l.id,$.isFunction(u.loaddata)?$.extend(i,u.loaddata.apply(l,[l.revert,u])):$.extend(i,u.loaddata),$.ajax({type:u.loadtype,url:u.loadurl,data:i,async:!1,success:function(t){window.clearTimeout(r),e=t,s.disabled=!1}})}else u.data?(e=u.data,$.isFunction(u.data)&&(e=u.data.apply(l,[l.revert,u]))):e=l.revert;h.apply(n,[e,u,l]),s.attr("name",u.name),p.apply(n,[u,l]),$(l).append(n),d.apply(n,[u,l]),$(":input:visible:enabled:first",n).focus(),u.select&&s.select(),s.keydown(function(t){27==t.keyCode&&(t.preventDefault(),y.apply(n,[u,l]))}),"cancel"==u.onblur?s.blur(function(){r=setTimeout(function(){y.apply(n,[u,l])},500)}):"submit"==u.onblur?s.blur(function(){r=setTimeout(function(){n.submit()},200)}):$.isFunction(u.onblur)?s.blur(function(){u.onblur.apply(l,[s.val(),u])}):s.blur(function(){}),n.submit(function(t){if(r&&clearTimeout(r),t.preventDefault(),!1!==v.apply(n,[u,l])&&!1!==c.apply(n,[u,l]))if($.isFunction(u.target)){var e=u.target.apply(l,[s.val(),u]);$(l).html(e),l.editing=!1,f.apply(l,[l.innerHTML,u]),$.trim($(l).html())||$(l).html(u.placeholder)}else{var i={};i[u.name]=s.val(),i[u.id]=l.id,$.isFunction(u.submitdata)?$.extend(i,u.submitdata.apply(l,[l.revert,u])):$.extend(i,u.submitdata),"PUT"==u.method&&(i._method="put"),$(l).html(u.indicator);var a={type:"POST",data:i,dataType:"html",url:u.target,success:function(t){"html"==a.dataType&&$(l).html(t),l.editing=!1,f.apply(l,[t,u]),$.trim($(l).html())||$(l).html(u.placeholder)},error:function(t){_.apply(n,[u,l,t])}};$.extend(a,u.ajaxoptions),$.ajax(a)}return $(l).attr("title",u.tooltip),!1})}}),this.reset=function(t){this.editing&&!1!==i.apply(t,[u,l])&&($(l).html(l.revert),l.editing=!1,$.trim($(l).html())||$(l).html(u.placeholder),u.tooltip&&$(l).attr("title",u.tooltip))}})}$(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable")}else $(this).data("disabled.editable",!1);else $(this).data("disabled.editable",!0)},$.editable={types:{defaults:{element:function(){var t=$('<input type="hidden"></input>');return $(this).append(t),t},content:function(t){$(":input:first",this).val(t)},reset:function(t,e){e.reset(this)},buttons:function(e,i){var a=this;if(e.submit){if(e.submit.match(/>$/))var t=$(e.submit).click(function(){"submit"!=t.attr("type")&&a.submit()});else(t=$('<button type="submit" />')).html(e.submit);$(this).append(t)}if(e.cancel){if(e.cancel.match(/>$/))var n=$(e.cancel);else(n=$('<button type="cancel" />')).html(e.cancel);$(this).append(n),$(n).click(function(){if($.isFunction($.editable.types[e.type].reset))var t=$.editable.types[e.type].reset;else t=$.editable.types.defaults.reset;return t.apply(a,[e,i]),!1})}}},text:{element:function(t){var e=$("<input />");return"none"!=t.width&&e.width(t.width),"none"!=t.height&&e.height(t.height),e.attr("autocomplete","off"),$(this).append(e),e}},textarea:{element:function(t){var e=$("<textarea />");return t.rows?e.attr("rows",t.rows):"none"!=t.height&&e.height(t.height),t.cols?e.attr("cols",t.cols):"none"!=t.width&&e.width(t.width),$(this).append(e),e}},select:{element:function(){var t=$("<select />");return $(this).append(t),t},content:function(data,settings,original){if(String==data.constructor)eval("var json = "+data);else var json=data;for(var key in json)if(json.hasOwnProperty(key)&&"selected"!=key){var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}$("select",this).children().each(function(){$(this).val()!=json.selected&&$(this).text()!=$.trim(original.revert)||$(this).attr("selected","selected")})}}},addInputType:function(t,e){$.editable.types[t]=e}},$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}}(jQuery),function(){var a=function(t,e){return function(){return t.apply(e,arguments)}};pe.users||(pe.users={}),pe.users.SummaryEditor=function(){function t(t){var e,i;this.container=t,this.on_summary_keyup=a(this.on_summary_keyup,this),this.on_submit_summary=a(this.on_submit_summary,this),this.summary_container=this.container.find(".EditableSummary"),this.counter=this.container.find(".SummaryCounter"),this.counter_container=this.container.find(".CounterContainer"),this.counter_container.hide(),this.counter.html(200-this.summary_container.html().length),e={placeholder:"Say something about yourself. Click here.",type:"textarea",cssclass:"textarea_editable",onblur:"submit",rows:2,select:!1,submit:'<button class="save_button" style="display: none">Save</button>',data:function(t){return t.replace(/<br[\s\/]?>/gi,"\n")}},this.summary_container.editable(this.on_submit_summary,e),this.summary_container.click((i=this,function(){return i.counter_container.show(),i.on_summary_keyup(),i.summary_container.find("textarea").bind("propertychange input textInput",i.on_summary_keyup),i.summary_container.find("textarea").keypress(i.on_summary_keyup)}))}return t.prototype.on_submit_summary=function(t){var e,i;return this.counter_container.hide(),i={user:{summary:t},_method:"put"},e=pe.routes.current_url_params(),i.id=e.user_id||e.id,pe.routes.Request.from_current_location("api_user",i).post(),t.replace(/\n/g,"<br>")},t.prototype.on_summary_keyup=function(t){var e,i,a;if(!t||13!==t.which)return(e=200-(i=(a=this.summary_container.find("textarea")).val()).length)<=0&&(e=0,a.val(i.slice(0,200))),this.counter.html(e);this.summary_container.find(".save_button").click()},t}()}.call(this);