!function(a){a.cookie=function(e,t,i){if(1<arguments.length&&(!/Object/.test(Object.prototype.toString.call(t))||null===t||t===undefined)){if(i=a.extend({},i),null!==t&&t!==undefined||(i.expires=-1),"number"==typeof i.expires){var o=i.expires,n=i.expires=new Date;n.setDate(n.getDate()+o)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",i.raw?t:encodeURIComponent(t),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l,c=(i=t||{}).raw?function(e){return e}:decodeURIComponent,s=document.cookie.split("; "),u=0;l=s[u]&&s[u].split("=");u++)if(c(l[0])===e)return c(l[1]||"");return null}}(jQuery),pe.CloseButton=function(e,t){if(pe.init_widget(this,e),this.close_button=e.find(".CloseButton"),"function"==typeof t)this.close_button.click(t);else switch(t){case pe.CloseButton.close_methods.REMOVE:this.close_button.click(this.callback(this.remove_container));break;case pe.CloseButton.close_methods.HIDE:this.close_button.click(this.callback(this.hide_container));break;default:alert("unknown value for 'close_method' parameter.")}},pe.CloseButton.close_methods={REMOVE:"REMOVE",HIDE:"HIDE"},pe.CloseButton.events={CLOSED:"CloseButton_CLOSED"},pe.CloseButton.prototype.remove_container=function(){return this.container.detach(),this.fire_event(pe.CloseButton.events.CLOSED),this.container.remove(),!1},pe.CloseButton.prototype.hide_container=function(){return this.fire_event(pe.CloseButton.events.CLOSED),this.container.hide(),!1},pe.SingleSelectionAutocompleteField=function(e,t,i,o){pe.init_widget(this,e),this.on_item_selected=null,this.close_button_callback=null,this.autocomplete_data_or_url=t,this.input_field_name=i,this.container.html(this.html()),this.dummy_input_field=this.container.find(".DummyInputField"),this.messaging_area=this.container.find(".Messaging"),this.autocomplete_input_field=this.container.find(".AutocompleteField"),this.autocomplete_handler(),this.selected_data_container=this.container.find(".SelectedValue"),o&&this.set_field_value(o)},pe.SingleSelectionAutocompleteField.events={SELECTED:"SingleSelectionAutocompleteField_SELECTED"},pe.SingleSelectionAutocompleteField.prototype.set_autocomplete_url=function(e){e&&(this.autocomplete_data_or_url=e,this.autocomplete_handler())},pe.SingleSelectionAutocompleteField.prototype.set_field_value=function(e){e&&0!==e.length&&(this.remove_dummy_row(),this.autocomplete_data_selected(e),this.enforce_limit())},pe.SingleSelectionAutocompleteField.prototype.add_dummy_row=function(){this.dummy_input_field||(this.dummy_input_field=$('<input class="DummyInputField"        type="hidden" name="'+this.input_field_name+'"       value="x_mock_single_value_x">'),this.autocomplete_input_field.after(this.dummy_input_field))},pe.SingleSelectionAutocompleteField.prototype.autocomplete_data_selected=function(e){this.selected_data=e,this.remove_dummy_row(),this.selected_data_container.append(this.selected_data_html(e.label,e.id,e.category)),new pe.CloseButton(this.selected_data_container.find(".SelectedInputData").last(),pe.CloseButton.close_methods.REMOVE).bind_event(pe.CloseButton.events.CLOSED,this.callback(this.close_button_clicked)),this.enforce_limit(),this.on_item_selected&&this.on_item_selected(e)},pe.SingleSelectionAutocompleteField.prototype.item_selected=function(e){this.on_item_selected=e},pe.SingleSelectionAutocompleteField.prototype.autocomplete_handler=function(){this.autocomplete_input_field.autocomplete({source:this.autocomplete_data_or_url,minLength:1,focus:function(){return!1},close:this.callback(function(){this.autocomplete_input_field.val("")}),select:this.callback(function(e,t){var i=t.item;this.autocomplete_data_selected(i),this.fire_event(pe.SingleSelectionAutocompleteField.events.SELECTED,i.id)})}).data("autocomplete")._renderItem=function(e,t){return t.display_label=t.category?pe.templatize("{{label}} ({{category}})",t):t.label,$("<li></li>").data("item.autocomplete",t).append(pe.templatize("<a>{{display_label}}</a>",t)).appendTo(e)}},pe.SingleSelectionAutocompleteField.prototype.clear_selected_data=function(){this.selected_data_container.html(""),this.add_dummy_row()},pe.SingleSelectionAutocompleteField.prototype.close_button_clicked=function(){0===this.selected_data_container.find(".SelectedInputData").length&&this.add_dummy_row(),this.enforce_limit(),this.close_button_callback&&this.close_button_callback(),this.autocomplete_input_field.show(),this.autocomplete_input_field.focus()},pe.SingleSelectionAutocompleteField.prototype.display_close_button=function(){this.selected_data_container.find(".CloseButton").show()},pe.SingleSelectionAutocompleteField.prototype.enforce_limit=function(){0<this.selected_data_container.find(".SelectedInputData").length?this.autocomplete_input_field.autocomplete("disable"):this.autocomplete_input_field.autocomplete("enable")},pe.SingleSelectionAutocompleteField.prototype.hide_close_button=function(){this.selected_data_container.find(".CloseButton").hide()},pe.SingleSelectionAutocompleteField.prototype.html=function(){return'<input class="AutocompleteField" type="text"><input class="DummyInputField" type="hidden" name="'+this.input_field_name+'" value="x_mock_single_value_x"><div class="SelectedValue"></div>'},pe.SingleSelectionAutocompleteField.prototype.remove_dummy_row=function(){this.dummy_input_field&&(this.dummy_input_field.remove(),this.dummy_input_field=null)},pe.SingleSelectionAutocompleteField.prototype.replace_data_in_list=function(e){this.clear_selected_data(),this.set_field_value(e)},pe.SingleSelectionAutocompleteField.prototype.selected_data_html=function(e,t,i){return'<div class="SelectedInputData selected_data"><img style="margin-right:20px; width: 15px; height: 15px;" src="/assets/events/close.png"class="CloseButton float_left">  <div>'+(i?e+"("+i+")":e)+'</div>  <input type="hidden" value="'+t+'" name="'+this.input_field_name+'"></div>'},pe.SingleSelectionAutocompleteField.prototype.val=function(){return this.dummy_input_field?"":this.container.find('input[name="'+this.input_field_name+'"]').val()},function(){var l=function(e,t){return function(){return e.apply(t,arguments)}};pe.PerformerJumper=function(){function e(e,t,i){var o,n;this.container=e,this.url=t,this.field_name=i,this.on_write_review_button_clicked=l(this.on_write_review_button_clicked,this),this.on_item_selected=l(this.on_item_selected,this),this.item=null,this.autocomplete=new pe.SingleSelectionAutocompleteField(this.container.find(".Autocomplete"),this.url,this.field_name),this.write_review_button=this.container.find(".WriteReviewButton"),this.write_review_button.click(this.on_write_review_button_clicked),this.write_review_button.click((o=this,function(){return!!o.item})),this.autocomplete.item_selected(this.on_item_selected),this.autocomplete.close_button_callback=(n=this,function(){return n.item=null,n.write_review_button.addClass("disabled")})}return e.prototype.on_item_selected=function(e){if(this.write_review_button.toggleClass("disabled",e),this.item=e)return this.write_review_button.attr("href",e.value+"#WriteComment")},e.prototype.on_write_review_button_clicked=function(){var e;return e=JSON.stringify({notice:this.write_review_button.data("message")}),$.cookie("flash",e,{path:"/"}),!0},e}()}.call(this);