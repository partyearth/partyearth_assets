!function(a){a.cookie=function(e,t,i){if(1<arguments.length&&(!/Object/.test(Object.prototype.toString.call(t))||null===t||t===undefined)){if(i=a.extend({},i),null!==t&&t!==undefined||(i.expires=-1),"number"==typeof i.expires){var n=i.expires,o=i.expires=new Date;o.setDate(o.getDate()+n)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",i.raw?t:encodeURIComponent(t),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var r,s=(i=t||{}).raw?function(e){return e}:decodeURIComponent,c=document.cookie.split("; "),_=0;r=c[_]&&c[_].split("=");_++)if(s(r[0])===e)return s(r[1]||"");return null}}(jQuery),function(){var o=function(e,t){return function(){return e.apply(t,arguments)}};pe.CityBasedVenueJumper=function(){function e(e,t,i){var n;this.container=e,this.url=t,this.field_name=i,this.on_item_selected=o(this.on_item_selected,this),this.on_write_review_button_clicked=o(this.on_write_review_button_clicked,this),this.city_changed=o(this.city_changed,this),this.item=null,this.write_review_button=this.container.find(".WriteReviewButton"),this.cities_selector_container=this.container.find(".CitySelector"),this.venues_selector_container=this.container.find(".VenueSelector"),this.write_review_button.click(this.on_write_review_button_clicked),this.cities_selector_container.change(this.city_changed),this.venues_selector_container.change(this.on_item_selected),this.write_review_button.click((n=this,function(){return!!n.venues_selector_container.val()}))}return e.prototype.city_changed=function(){return this.city=this.cities_selector_container.val(),this.container=this.venues_selector_container,this.options="",this.city?$.getJSON(this.url,{city_id:this.city},(o=this,function(e){var t,i,n;for(t=i=0,n=e.length;0<=n?i<n:n<i;t=0<=n?++i:--i)o.options+='<option value="'+e[t].value+'">'+e[t].label+"</option>";return o.container.html(o.options),o.on_item_selected()})):(this.container.html(this.options),this.on_item_selected());var o},e.prototype.on_write_review_button_clicked=function(){var e;return e=JSON.stringify({notice:this.write_review_button.data("message")}),$.cookie("flash",e,{path:"/"}),!0},e.prototype.on_item_selected=function(){var e;return(e=this.venues_selector_container.val())?(this.write_review_button.attr("href",e+"#WriteComment"),this.write_review_button.removeClass("disabled")):this.write_review_button.addClass("disabled")},e}()}.call(this);